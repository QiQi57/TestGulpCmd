function BuildTimeRange_nouse(){for(var e='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendAll(\'TimeRangeList\',\'txtTime\',\'txtTimeHidden\');" checked="checked"  value="All" />Select all<br />',t=new Date,a=t.getFullYear(),i=t.getMonth(),n=1,o=2012;a>=o;o++){var c=o.toString().substring(2);a>o&&(e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1" />FY'+c+" Q1<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2" />FY'+c+" Q2<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3" />FY'+c+" Q3<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q4" />FY'+c+" Q4<br />",n+=4),o==a&&3>i&&(e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1" />FY'+c+" Q1<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2" />FY'+c+" Q2<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3" />FY'+c+" Q3<br />",n+=3),o==a&&6>i&&i>2&&(e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1" />FY'+c+" Q1<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2" />FY'+c+" Q2<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3" />FY'+c+" Q3<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q4" />FY'+c+" Q4<br />",n+=4),o==a&&i>5&&9>i&&(e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1" />FY'+c+" Q1<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2" />FY'+c+" Q2<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3" />FY'+c+" Q3<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q4" />FY'+c+" Q4<br />",c=parseInt(c)+1,e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1" />FY'+c+" Q1<br />",n+=5),o==a&&i>8&&12>i&&(e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1" />FY'+c+" Q1<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2" />FY'+c+" Q2<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3" />FY'+c+" Q3<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q4" />FY'+c+" Q4<br />",c=parseInt(c)+1,e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1" />FY'+c+" Q1<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2" />FY'+c+" Q2<br />",n+=6)}$("#TimeRangeList").append(e),$("#TimeRangeList").height(16*n)}function BuildTimeRange(){var e='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendAll(\'TimeRangeList\',\'txtTime\',\'txtTimeHidden\');" checked="checked"  value="All" />Select all<br />',t=new Date,a=t.getFullYear(),i=t.getMonth()+1,n=1,o=2013;o=7>i?a-1:a;var c=o.toString().substring(2);e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M1" />FY'+c+" Q1-Jul<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M2" />FY'+c+" Q1-Aug<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M3" />FY'+c+" Q1-Sep<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M4" />FY'+c+" Q2-Oct<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M5" />FY'+c+" Q2-Nov<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M6" />FY'+c+" Q2-Dec<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3M7" />FY'+c+" Q3-Jan<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3M8" />FY'+c+" Q3-Feb<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3M9" />FY'+c+" Q3-Mar<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q4M10" />FY'+c+" Q4-Apr<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q4M11" />FY'+c+" Q4-May<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q4M12" />FY'+c+" Q4-Jun<br />",n+=12,o+=1;var c=o.toString().substring(2);if(9>=i&&i>=7){switch(i){case 7:e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M1" />FY'+c+" Q1-Jul<br />";break;case 8:e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M1" />FY'+c+" Q1-Jul<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M2" />FY'+c+" Q1-Aug<br />";break;case 9:e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M1" />FY'+c+" Q1-Jul<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M2" />FY'+c+" Q1-Aug<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M3" />FY'+c+" Q1-Sep<br />"}n+=i-6}if(12>=i&&i>=10){switch(e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M1" />FY'+c+" Q1-Jul<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M2" />FY'+c+" Q1-Aug<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M3" />FY'+c+" Q1-Sep<br />",i){case 10:e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M4" />FY'+c+" Q2-Oct<br />";break;case 11:e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M4" />FY'+c+" Q2-Oct<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M5" />FY'+c+" Q2-Nov<br />";break;case 12:e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M4" />FY'+c+" Q2-Oct<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M5" />FY'+c+" Q2-Nov<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M6" />FY'+c+" Q2-Dec<br />"}n+=i-6}if(3>=i&&i>=1){switch(e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M1" />FY'+c+" Q1-Jul<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M2" />FY'+c+" Q1-Aug<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M3" />FY'+c+" Q1-Sep<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M4" />FY'+c+" Q2-Oct<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M5" />FY'+c+" Q2-Nov<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M6" />FY'+c+" Q2-Dec<br />",i){case 1:e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3M7" />FY'+c+" Q3-Jan<br />";break;case 2:e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3M7" />FY'+c+" Q3-Jan<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3M8" />FY'+c+" Q3-Feb<br />";break;case 3:e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3M7" />FY'+c+" Q3-Jan<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3M8" />FY'+c+" Q3-Feb<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3M9" />FY'+c+" Q3-Mar<br />"}n+=i+6}if(6>=i&&i>=4){switch(e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M1" />FY'+c+" Q1-Jul<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M2" />FY'+c+" Q1-Aug<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q1M3" />FY'+c+" Q1-Sep<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M4" />FY'+c+" Q2-Oct<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M5" />FY'+c+" Q2-Nov<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q2M6" />FY'+c+" Q2-Dec<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3M7" />FY'+c+" Q3-Jan<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3M8" />FY'+c+" Q3-Feb<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q3M9" />FY'+c+" Q3-Mar<br />",i){case 4:e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q4M10" />FY'+c+" Q4-Apr<br />";break;case 5:e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q4M10" />FY'+c+" Q4-Apr<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q4M11" />FY'+c+" Q4-May<br />";break;case 6:e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q4M10" />FY'+c+" Q4-Apr<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q4M11" />FY'+c+" Q4-May<br />",e+='<input type="checkbox" id="TimeRangeCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'TimeRangeList\', \'txtTime\', \'txtTimeHidden\');" checked="checked" value="FY'+c+'Q4M12" />FY'+c+" Q4-Jun<br />"}n+=i+6}$("#TimeRangeList").append(e),$("#TimeRangeList").height(16*n)}function getSTL2(){var e=$("#SP_Selection").val(),t=getHostUrl();$.post(t+"/GetSTL2.srv",{STL1:e},function(e){$("#STL2_Selection").find("option").remove();var t=$.parseJSON(e);$("#STL2_Selection").append("<option value='All'>All</option>");for(var a=0;a<t.length;a++)$("#STL2_Selection").append("<option value='"+t[a]+"'>"+t[a]+"</option>")})}function getSupportTopicLevel2(e){var t=e,a=getHostUrl();$.post(a+"/GetSTL2ByMultipleST1.srv",{level1Name:t},function(e){var t=$.parseJSON(e);$("#contentTable").html(t);var i="",n=$('input[type="checkbox"][name="radio"]:checked');n.each(function(e,t){i+=$(t).val()+","}),$("#proLevel2NameHidden").val(i.substring(0,i.length-1)),$.ajax({url:a+"/GetProductIDByPL2.srv",type:"POST",data:{ProductLevel2Names:i.replace(/,/g,"','").substring(0,i.replace(/,/g,"','").length-3)},async:!1,success:function(e){if("parameter error"!=e){var t=$.parseJSON(e),a="",i=0;$.each(t,function(e,t){a+=t.ProductID.toString()+",",i++}),$("#txtProductTreeHidden").val(a.substring(0,a.length-1)),selectedProducts=a,0==i?$("#txtProductTree").attr("value","Selected 0 item"):1==i?$("#txtProductTree").attr("value","Selected "+i+" item"):$("#txtProductTree").attr("value","Selected "+i+" items")}}}),$("#ProLevel2Hidden").val(i.substring(0,i.length-1)),0==bindFlag?getProductInfoFlag():getProductInfo()})}function sortFunction(e,t){for(var a=0,i=0,n=0;n<e.toString().length;n++)a+=e.charCodeAt(n);for(var n=0;n<t.toString().length;n++)i+=t.charCodeAt(n);return a-i}function clearRadioButton(e,t){for(var a=document.getElementById(t),i=0;i<a.length;i++)a[i].name==e&&(document.getElementById(a[i].id).checked=!1,$("#Span"+a[i].id).attr("class",radio_unchecked))}function getHostUrl(){var e=window.location.protocol,t=window.location.host;return e+"//"+t+pathDir}function CloseDetailsBinding(){$("#closeDetails").click(function(){$("#detailsView").html(""),$("#closeDetails").attr("class","triangle-down-click"),$("#detailsView").fadeOut("slow")}),$("#closeDetails").mousedown(function(){$("#closeDetails").attr("class","triangle-down-click")}),$("#closeDetails").mouseup(function(){$("#closeDetails").attr("class","triangle-down")}),$("#closeDetails").mouseover(function(){$("#closeDetails").attr("class","triangle-down-click")}),$("#closeDetails").mouseout(function(){$("#closeDetails").attr("class","triangle-down")})}function CloseDetailsBindingTrend(){$("#closeTrend").click(function(){$("#trendContent").html("<div>Closing...</div>"),$("#trendTransition").hide(),$("#trendMask").hide(),$("#closeTrend").attr("class","triangle-down-click-trend")}),$("#closeTrend").mousedown(function(){$("#closeTrend").attr("class","triangle-down-click-trend")}),$("#closeTrend").mouseup(function(){$("#closeTrend").attr("class","triangle-down-trend")}),$("#closeTrend").mouseover(function(){$("#closeTrend").attr("class","triangle-down-click-trend")}),$("#closeTrend").mouseout(function(){$("#closeTrend").attr("class","triangle-down-trend")})}function ClickScore(e,t){$("#ScoreCardId").val(e),$("#ScoreCardName").val(t),$("#spanScorecard").text(t),$(this).css("font-weight","bold"),$("#orgAccord").load("_OrganizationSelect",{scorecardId:e},successLoadOrg)}function ClickOrg(e,t,a){$("#OrganizationId").val(e),$("#spanOrg").text(a),$("#OrganizationName").val(t),$(this).css("font-weight","bold"),$("#businessAccord").load("_BusinessSelect",{scorecardId:$("#ScoreCardId").val(),organizationId:e},successLoadBusiness),$("#regionAccord").load("_RegionSelect",{organizationId:e},successLoadRegion)}function ClickBusiness(e,t){$("#BusinessUnitId").val(e),$("#BusinessUnitName").val(t),$(this).css("font-weight","bold"),$("#spanBusiness").text(t);var a=$("#ScoreCardId").val(),i=$("#OrganizationId").val(),n=$("#BusinessUnitId").val(),o=$("#RegionId").val();""!=o&&"0"!=o&&($("#lobAccord").load("_LOBSelect",{scorecardId:a,organizationId:i,businessUnitId:n,regionId:o},successLoadLob),$("#lobAccord").css("display","inline"))}function ClickRegion(e,t){$("#RegionId").val(e),$("#RegionName").val(t),$("#spanRegion").text(t),$(this).css("font-weight","bold");var a=$("#ScoreCardId").val(),i=$("#OrganizationId").val(),n=$("#BusinessUnitId").val(),o=$("#RegionId").val();$("#lobAccord").load("_LOBSelect",{scorecardId:a,organizationId:i,businessUnitId:n,regionId:o},successLoadLob),$("#lobAccord").css("display","inline")}function ClickLOB(e){$("#"+e).is(":checked")?$("#"+e).is(":checked")&&(GetCat(),GetLob()):($("#check_all").attr("checked",!1),GetCat(),GetLob());var t=$("#ScoreCardId").val(),a=$("#OrganizationId").val(),i=$("#BusinessUnitId").val(),n=$("#Lob").val(),o=$("#RegionId").val();$("#catAccord").load("_CategorySelect",{scorecardId:t,organizationId:a,businessUnitId:i,regionId:o,lineOfBusinessId:n},successLoadCat),$("#catAccord").css("display","inline")}function ClickCat(e){$("#CategoryId").val(e),$("#"+e).is(":checked")||$("#check_allcat").attr("checked",!1)}function GetLob(){for(var e=document.getElementById("lobAccord"),t="",a=e.getElementsByTagName("input"),i=a.length,n=0;i>n;n++)"checkbox"===a[n].type&&a[n].checked&&a[n].name.match("^lobCheck")&&(t+=a[n].name.split("_")[1]+",");""!=t&&(document.getElementById("Lob").value=t.substring(0,t.length-1))}function GetCat(){for(var e=document.getElementById("catAccord"),t="",a=e.getElementsByTagName("input"),i=a.length,n=0;i>n;n++)"checkbox"===a[n].type&&a[n].checked&&a[n].name.match("^catCheck")&&(t+=a[n].name.split("_")[1]+",");""!=t&&(document.getElementById("Category").value=t.substring(0,t.length-1))}function Validate(){var e=!0,t="";return(""==$("#ScoreCardId").val()||"0"==$("#ScoreCardId").val())&&(t+="Please Select Scorecard Id\n",e=!1),""==$("#OrganizationId").val()&&(t+="Please Select Organization Id\n",e=!1),""==$("#BusinessUnitId").val()&&(t+="Please Select Business Unit Id\n",e=!1),""==$("#RegionId").val()&&(t+="Please Select Region Id\n",e=!1),""==$("#Lob").val()&&(t+="Please Select Lob Checkbox\n",e=!1),""==$("#Category").val()&&(t+="Please Select Category Checkbox\n",e=!1),""==$("#Year").val()&&(t+="Please Select Year\n",e=!1),(""==$("#Month").val()||"0"==$("#Month").val())&&(t+="Please Select Month\n",e=!1),0==e&&alert(t),e}function Prev(){var e=$("label[for=Year]").html(),t=parseInt(e)-1;$("label[for=Year]").html(t),document.getElementById("Year").value=$("label[for=Year]").html()}function Next(){var e=$("label[for=Year]").html(),t=parseInt(e)+1;$("label[for=Year]").html(t),document.getElementById("Year").value=$("label[for=Year]").html()}function ClickMonth(e){document.getElementById("Year").value=$("label[for=Year]").html(),document.getElementById("Month").value=e}function LevelClick(e){if(null!=$("#showContent"+e))if($("#showContent"+e).is(":visible")){var t=$("#expandcol"+e).attr("src");""!=t&&void 0!=t&&(t=t.replace("collapse-green.gif","expand-green.gif"),$("#expandcol"+e).attr("src",t),$("#showContent"+e).slideUp())}else{var t=$("#expandcol"+e).attr("src");""!=t&&void 0!=t&&(t=t.replace("expand-green.gif","collapse-green.gif"),$("#expandcol"+e).attr("src",t),$("#showContent"+e).slideDown())}}function RadioClickedByTopIssue(e,t,a){for(var i=document.getElementById(a),n=0;n<i.length;n++)i[n].name==t&&($("#"+i[n].id).checked=!1,$("#Span"+i[n].id).attr("class",cluster_unchecked));return document.getElementById(e).checked=!0,$("#Span"+e).attr("class",cluster_checked),!1}function ReloadProductTree01(){matchString="",$("#matchtextbox").val(""),$("#tree div").html(""),$("#productsNameList span").html(""),o.data=[{id:"All",Text:"All",Value:"All",showcheck:!1,complete:!1,isexpand:!1,checkstate:0,hasChildren:!0,ChildNodes:null,Level:"0"}],identifier=!0,treeNodesCount=1,$("#txtProductTree").attr("value","Selected 0 Item"),selectedProducts="",$("#txtProductTreeHidden").attr("value",""),$("#tree").treeview(o),$("#tree").width(230)}function SetProductTreeStateBySelectedLevel1(){if("ProView"==isTreeOrProView){var e="",t=$('input[type="checkbox"][name="radio"]:checked');t.each(function(t,a){e+=$(a).val()+","});var a=getHostUrl()+"/GetCommercialProLevel1Names.srv",i="'"+e.substring(0,e.length-1)+"'";proL2Names=i.replace(/,/g,"','");var n="";$.ajax({url:a,type:"POST",data:{ProL2Names:proL2Names},success:function(e){setTimeout(function(){var t=$.parseJSON(e);$.each(t,function(e,t){n+=t.CommProLve1Name+",",productsLevel1.push(t.CommProLve1Name),$.each(t.CommProLevel3Name.split("^"),function(e,t){productsLevel3.push(t)}),isTriggeredByRadio=!0,"bbit-tree-ec-icon bbit-tree-elbow-plus"==$("#tree div[level='1'][title='"+t.CommProLve1Name+"'] .bbit-tree-ec-icon").attr("class")&&$("#tree div[level='1'][title='"+t.CommProLve1Name+"'] .bbit-tree-ec-icon").click()}),n=n.substring(0,n.length-1);var a=n.split(",");$("#tree div[level='1']").each(function(e,t){var i=$.inArray($(this).attr("title"),a);-1==i&&"bbit-tree-ec-icon bbit-tree-elbow-minus"==$(this).children(".bbit-tree-ec-icon").attr("class")&&$(this).children(".bbit-tree-ec-icon").click()})},0)}})}}function RankClicked(e,t,a){isTreeOrProView="ProView",ReloadProductTree01();for(var i=(document.getElementById(a),document.getElementById("filterFormAV")),n="av",o=0;o<i.length;o++)i[o].name==n&&(document.getElementById(i[o].id).checked=!1,$("#Span"+i[o].id).attr("class",topIssue_unchecked_AV));document.getElementById(e).checked?(document.getElementById(e).checked=!1,$("#Span"+e).attr("class",topIssue_unchecked)):(document.getElementById(e).checked=!0,$("#Span"+e).attr("class",topIssue_checked)),$("#divCheckBoxList").html("Please wait...");var c="",d=$('input[type="checkbox"][name="radio"]:checked');d.each(function(e,t){c+=$(t).val()+","}),$("#proLevel2NameHidden").val(c.substring(0,c.length-1)),selectedProducts="";var l=getHostUrl();return $.post(l+"/GetProductIDByPL2.srv",{ProductLevel2Names:c.replace(/,/g,"','").substring(0,c.replace(/,/g,"','").length-3)},function(e){if("parameter error"!=e){var t=$.parseJSON(e),a="",i=0;$.each(t,function(e,t){a+=t.ProductID.toString()+",",i++}),$("#txtProductTreeHidden").val(a.substring(0,a.length-1)),selectedProducts=a,0==i?$("#txtProductTree").attr("value","Selected 0 item"):1==i?$("#txtProductTree").attr("value","Selected "+i+" item"):$("#txtProductTree").attr("value","Selected "+i+" items"),getProductInfo()}}),$("#ProLevel2Hidden").val(c.substring(0,c.length-1)),ClearSelectedItems("txtTaxonomyHidden"),!1}function AVClicked_AV(e,t,a){isTreeOrProView="ProView",ReloadProductTree01();for(var i=document.getElementById(a),n=(document.getElementById("filterForm"),0);n<i.length;n++)i[n].name==t&&(document.getElementById(i[n].id).checked=!1,$("#Span"+i[n].id).attr("class",topIssue_unchecked_AV));document.getElementById(e).checked=!0;var o="";return $("#RadioFieldID18").attr("checked")?o="Cloud":$("#RadioFieldID19").attr("checked")?o="Dynamics":$("#RadioFieldID20").attr("checked")?o="ASG":$("#RadioFieldID21").attr("checked")&&(o="C&E"),getSupportTopicLevel2(o),$("#Span"+e).attr("class",topIssue_checked_AV),!1}function getProductInfo(){var e="",t="",a="",i="",n="";DisableViewReportButton();var o="month",c=$("#txtTimeHidden").val(),d="";n=$("#txtProductTreeHidden").val();var l=getHostUrl();$.post(l+"/GetTaxonomyByProductTree.srv",{productLevel1:e,productLevel2:t,productLevel3:a,productLevel4:i,productVersion:n,type:o,startDate:c,endDate:d},function(e){if(filterDictJson=$.parseJSON(e),""==filterDictJson||null==filterDictJson)$("#txtTaxonomy").val("(No Taxonomy)"),$("#divCheckBoxList").html("<p style='margin-top:8px'>Please select Audience View or Product View at first</p>"),divCheckBoxListHeight=30;else{var t="",a=16,i=1;t='<input type="checkbox" id="taxonomyCheckBox" class="CheckBoxList" onchange="AppendAll(\'divCheckBoxList\',\'txtTaxonomy\',\'txtTaxonomyHidden\');" value="All" />All <br />';var n="";$.each(filterDictJson,function(e,a){t+='<input type="checkbox" id="taxonomyCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'divCheckBoxList\',\'txtTaxonomy\',\'txtTaxonomyHidden\');" value="'+a+'" checked="checked"/>'+a+"<br />",i+=1,n+=a+"^"}),$("#taxonomyHidden").val(n.substring(0,n.length-1)),$("#divCheckBoxList").html(t),divCheckBoxListHeight=i>34?34*a:i>25&&35>i?a*i+8:a*i+4,AppendCheckBoxInfo("divCustomCheckBoxList","txtTaxonomy","txtTaxonomyHidden"),EnableViewReportButton()}})}function getProductInfoFlag(){var e="",t="",a="",i="",n="";DisableViewReportButton();var o="quater",c=$("#txtTimeHidden").val(),d="",l=$('input[type="checkbox"][name="radio"]:checked');l.each(function(e,a){t+=$(a).val()+","}),n=$("#txtProductTreeHidden").val();var s=getHostUrl();$.post(s+"/GetTaxonomyByProductTree.srv",{productLevel1:e,productLevel2:t,productLevel3:a,productLevel4:i,productVersion:n,type:o,startDate:c,endDate:d},function(e){if(filterDictJson=$.parseJSON(e),""==filterDictJson||null==filterDictJson)$("#txtTaxonomy").val("(No Taxonomy)"),$("#divCheckBoxList").html("<p style='margin-top:8px'>Please select Audience View or Product View at first</p>"),divCheckBoxListHeight=30;else{var t="",a=16,i=1;t='<input type="checkbox" id="taxonomyCheckBox" class="CheckBoxList" onchange="AppendAll(\'divCheckBoxList\',\'txtTaxonomy\',\'txtTaxonomyHidden\');" value="All" />All <br />';var n="";$.each(filterDictJson,function(e,a){t+='<input type="checkbox" id="taxonomyCheckBox" class="CheckBoxList" onchange="AppendCheckBoxInfo(\'divCheckBoxList\',\'txtTaxonomy\',\'txtTaxonomyHidden\');" value="'+a+'" checked="checked"/>'+a+"<br />",i+=1,n+=a+"^"}),$("#taxonomyHidden").val(n.substring(0,n.length-1)),$("#divCheckBoxList").html(t),divCheckBoxListHeight=i>34?34*a:i>25&&35>i?a*i+8:a*i+4,AppendCheckBoxInfo("divCustomCheckBoxList","txtTaxonomy","txtTaxonomyHidden"),EnableViewReportButton()}bindFlag=!0,RestorePageStatus()})}function AppendAll(e,t,a){if($("#"+e+" input:checkbox:first").attr("checked")){var i=0,n="";$("#"+e+" input:checkbox").each(function(t,a){$(this).attr("checked",!0),i+=1,n+="divCheckBoxList"==e?$(this).val()+"^":$(this).val()+","}),n=n.substring(0,n.length-1),("txtregionhidden"==a.toLocaleLowerCase()||"txttaxonomyhidden"==a.toLocaleLowerCase())&&(n="All"),$("#"+a).attr("value",n),i-=1,$("#"+t).get(0).value="Selected all "+i+" items"}else $("#"+e+" input:checkbox").each(function(e,t){$(this).attr("checked",!1)}),$("#"+t).get(0).value="Selected 0 item",ClearSelectedItems(a);"TimeRangeList"==e&&getProductInfo()}function AppendCheckBoxInfo(e,t,a){d=$("#"+e+" input:checkbox").get().length-1;var i=0,n="",o="";if($("#"+e+" input:checkbox[value!='All']:checked").each(function(){n+="divCustomCheckBoxList"==e||"divCheckBoxList"==e?$(this).val()+"^":$(this).val()+",",i+=1}),n=n.substring(0,n.length-1),$("#"+a).attr("value",n),i==d&&($("#"+e+" input:checkbox:first").attr("checked",!0),
o="Selected all "+i+" items",("txtregionhidden"==a.toLocaleLowerCase()||"txttaxonomyhidden"==a.toLocaleLowerCase())&&$("#"+a).attr("value","All")),d>i&&($("#"+e+" input:checkbox:first").attr("checked",!1),o=1==i?"Selected "+i+" items":"Selected "+i+" items"),0==i&&($("#"+e+" input:checkbox:first").attr("checked",!1),o="Selected 0 item"),$("#"+t).attr("value",o),"TimeRangeList"==e&&getProductInfo(),""!=checkedTaxonomy&&1==bindFlag){var c=new Array;if(c=checkedTaxonomy.split("^"),1==c.length&&"All"==c[0])return;$("#divCheckBoxList input:checkbox").each(function(e,t){$(this).attr("checked",!1)});var d=0;$.each(c,function(e,t){$("#divCheckBoxList input:checkbox").each(function(e,a){$(this).val()==t&&"All"!=$(this).val()&&($(this).attr("checked",!0),d+=1)})}),d==$("#divCheckBoxList input:checkbox").length-1?($("#divCheckBoxList input:checkbox").each(function(e,t){"All"==$(this).val()&&$(this).attr("checked",!0)}),$("#txtTaxonomy").val("Selected all "+d+" items")):$("#txtTaxonomy").val("Selected "+d+" items");var l="",s=0;$("#divCheckBoxList input:checkbox[value!='All']:checked").each(function(){l+=$(this).val()+"^",s+=1}),l=l.substring(0,l.length-1),$("#"+a).attr("value",l),checkedTaxonomy=""}}function ClearSelectedItems(e){$("#"+e).attr("value","")}function ViewReport(e){DisableViewReportButton(),$("#detailsView").fadeOut(0),$("#showData").hide();var t="",a="",i="'"+$("#ProLevel2Hidden").val()+"'";if(i=i.replace(/,/g,"','"),"ProView"==isTreeOrProView){var n=getHostUrl()+"/GetCommercialProLevel1Names.srv",o="'"+$("#proLevel2NameHidden").val()+"'";i=o.replace(/,/g,"','"),$.ajax({url:n,type:"POST",data:{ProL2Names:i},async:!1,success:function(e){var i=$.parseJSON(e);$.each(i,function(e,i){t+=i.CommProLve1Name+"^",a+=i.CommProLevel3Name+"^"}),$("#ProLevel1HiddenP").val(t.substring(0,t.length-1)),$("#ProLevel3HiddenP").val(a.substring(0,a.length-1))}})}else $("#ProLevel1HiddenP").val($("#ProLevel1Hidden").val()),$("#ProLevel3HiddenP").val($("#ProLevel3Hidden").val());$("#ProLevel2HiddenP").val($("#ProLevel2Hidden").val().replace(",","^"));var c="",d="",l="",s="",r="",h=$('input[type="radio"][name="av"]:checked');h.length>0&&(r=h.attr("id")),$("#overallInfoDiv").hide(),$("#totalSTSpan").text(""),$("#totalCaseSpan").text("");var u=$('input[type="checkbox"][name="radio"]:checked');u.each(function(e,t){s+=$(t).attr("id")+","}),c=$("#txtProductTreeHidden").val(),l=$("#txtcusRegionTreeHidden").val(),d=$("#txtOfferingTreeHidden").val(),""==d||null==d?(d="all",$("#OffLevel1HiddenP").val("All"),$("#OffLevel2HiddenP").val("All"),$("#OffLevel3HiddenP").val("All")):(d=d.substring(0,d.length-1),$("#OffLevel1HiddenP").val($("#OffLevel1Hidden").val()),$("#OffLevel2HiddenP").val($("#OffLevel2Hidden").val()),$("#OffLevel3HiddenP").val($("#OffLevel3Hidden").val())),""==l||null==l?(l="all",$("#CusRegLevel1HiddenP").val("All"),$("#CusRegLevel2HiddenP").val("All"),$("#CusRegLevel3HiddenP").val("All")):(l=l.substring(0,l.length-1),$("#CusRegLevel1HiddenP").val($("#CusRegLevel1Hidden").val()),$("#CusRegLevel2HiddenP").val($("#CusRegLevel2Hidden").val()),$("#CusRegLevel3HiddenP").val($("#CusRegLevel3Hidden").val())),s=s.substring(0,s.length-1);var g=$("#txtTaxonomyHidden").val(),m=$("#txtTimeHidden").val(),p=$('input[type="radio"][name="rank"]:checked').val(),v=$('input[type="radio"][name="top"]:checked').val(),k=$("#filterCritsit span.clusterSelect").text(),x="";x=$("#txtRegionHidden").val(),$("#txtQuaters").val(m),$("#txtRegionDetails").val(x),$("#txtCommercialProductLevel2Name").val(c),$("#txtCommercialProductLevel2ID").val(s),$("#TICReportTable > tbody").empty(),$("#TICReportTable").hide();var f=getHostUrl();$("#copyPESServicedID").val(d),$("#copyProductVersion").val($("#txtProductTreeHidden").val()),$("#copyCusGeoDerivedID").val(l);var T=$('input[type="radio"][name="rank"]:checked').attr("id"),b=$('input[type="radio"][name="top"]:checked').attr("id"),C=$("#filterCritsit span.clusterSelect").attr("id"),L="",B="",y="",R="",w="",I="";L=$("#tree").html(),L=escape(L),y=$("#tree").height(),R=$("#tree").width(),B=$("#txtProductTreeHidden").val(),I="<all id='allid' text='all' value='all' showcheck='false' complete='true' checkstate='0' isexpand='true' hasChildren='true'>",I=LoopNodes(allNodes[0].ChildNodes,I,0),I+="</all>",I=escape(I);var F=$("#txtProductTree").val();w=F.match(/\d+/)[0];var S="",P="",D="",H="",A="",Y="";S=$("#offeringTree").html(),S=escape(S),D=$("#offeringTree").height(),H=$("#offeringTree").width(),P=d,Y="<all id='allid' text='all' value='all' showcheck='false' complete='true' checkstate='0' isexpand='true' hasChildren='true'>",Y=LoopNodes(offeringallNodes[0].ChildNodes,Y,0),Y+="</all>",Y=escape(Y),F=$("#txtOfferingTree").val().toLowerCase(),A="selected all items"==F?"all":F.match(/\d+/)[0];var Q="",M="",V="",O="",N="",E="";Q=$("#cusRegionTree").html(),Q=escape(Q),V=$("#cusRegionTree").height(),O=$("#cusRegionTree").width(),M=l,E="<all id='allid' text='all' value='all' showcheck='false' complete='true' checkstate='0' isexpand='true' hasChildren='true'>",E=LoopNodes(cusRegionallNodes[0].ChildNodes,E,0),E+="</all>",E=escape(E),cusRegselectedItemsText=$("#txtcusRegionTree").val().toLowerCase(),N="selected all items"==cusRegselectedItemsText?"all":cusRegselectedItemsText.match(/\d+/)[0];var _=$('input[type="radio"][name="rank"]:checked').val(),U=1,z=!0,J=0;"click"==e&&SavePageStatusTopissue(s,m,g,x,T,b,C,r,L,B,I,y,R,w,_,"Viewreport","Topissue",isTreeOrProView,$("#ProLevel1HiddenP").val(),$("#ProLevel2HiddenP").val(),$("#ProLevel3HiddenP").val(),"",S,P,Y,D,H,A,$("#OffLevel1HiddenP").val(),$("#OffLevel2HiddenP").val(),$("#OffLevel3HiddenP").val(),Q,M,E,V,O,N,$("#CusRegLevel1HiddenP").val(),$("#CusRegLevel2HiddenP").val(),$("#CusRegLevel3HiddenP").val()),$("#loadImageDiv").show(),TimerStart(),$.post(f+"/GetSupportTopicByTimeRange.srv",{CommercialProductLevel2Name:c,Taxonomy:g,GeographyLevel3:x,TimeRangeType:"months",TimeRangeValue:m,RankType:p,RankValue:v,critsitValue:k,InputPESServiceID:d,CustomerGeographyDerivedID:l},function(e){TimerStop(),$("#loadImageDiv").hide(),$("#showData").hide(),$(".saveAction").show();var t=$.parseJSON(e),a=t.length;if(1>a)return 1==searchTimes?($("#showData").show(),void EnableViewReportButton()):(ViewReport("retry"),void(searchTimes+=1));var i,n="",o="",c=0,d=0,l=0;$("#overallInfoDiv").show(),$("#totalSTSpan").text(a.toString());for(var s=0;a>s;s++)-1!=parseInt(t[s].Volume)&&(d+=parseInt(t[s].Volume),l+=parseInt(t[s].Labor));$("#totalCaseSpan").text(d);for(var s=0;a>s;s++){i="#D3DFEE"==i?"#D3DFEE":"#fff",0==c&&(o="<td></td><td></td><td></td><td></td><td></td><td></td></tr>");var r=0;-1!=t[s].TB&&(r+=t[s].TB),-1!=t[s].MB&&(r+=t[s].MB),-1!=t[s].BB&&(r+=t[s].BB);var h=0,u=0,g=0,p=0,v=0;r>0?(-1!=t[s].TB?0==r?(h="0",h+="%"):(h=(t[s].TB/r*100).toFixed(1),h+="%"):(h="0",h+="%"),-1!=t[s].BB?0==r?(u="0",u+="%"):(u=(t[s].BB/r*100).toFixed(1),u+="%"):(u="0",u+="%")):(h="-",u="-",r=r),0!=l&&(g=t[s].Labor/l*100),0!=d&&(p=t[s].Volume/d*100),t[s].Critsit&&(v=t[s].Critsit);var k,x,f,T=t[s].SupportTopicDerivedID;-1==T&&($("#warningTitle").html("View Report :"),$("#warningText").html("Cannot find details about current Support Topic."),$(".warning").overlay().load()),k=-1==t[s].AvgTMPI?"-":t[s].AvgTMPI.toFixed(0),-1==t[s].Volume?(x="-",p="-"):(x=t[s].Volume,p=p.toFixed(1),p+="%"),-1==t[s].Labor?(f="-",g="-"):(f=t[s].Labor.toFixed(0),g=g.toFixed(1),g+="%");var b=t[s].SupportTopicFullPath.split("\\").length,C=t[s].CommercialProductLevel2Name,L=t[s].SupportTopicFullPath.split("\\"),B="";$.each(L,function(e,t){B+=t+"^"}),B=B.substring(0,B.length-1),z?b>2&&(n="<tr style='background-color:"+i+"'><td rowspan="+(c+1)+">"+U+"</td><td rowspan="+(c+1)+"><a id='BA"+s+"' tag='"+T+"'  href='#BB"+s+"' ><img id='imgBA"+s+"' class='TrendImage'   onclick='TrendClickEvent(\"BA"+s+'", "'+m+'" ,"'+T+'","'+C+'","'+B+'","'+g+'","'+f+'","'+k+'","'+p+'","'+x+'","'+h+'","'+u+'","'+r+"\");' /></a><a style='display:none;'>BB"+s+"</a></td><td rowspan="+(c+1)+">"+t[s].CommercialProductLevel2Name+"</td><td style='text-align:left;padding-left:20px;' rowspan="+(c+1)+">"+t[s].SupportTopicFullPath+"</td><td rowspan="+(c+1)+">"+g+"</td><td rowspan="+(c+1)+">"+f+"</td><td rowspan="+(c+1)+">"+k+"</td><td rowspan="+(c+1)+">"+p+"</td><td rowspan="+(c+1)+"><a id='AB"+s+"' tag='"+T+"'  onclick='enable(\"AB"+s+'", "'+t[s].CommercialProductLevel2Name+'", "'+B+"\")' href='#AA"+s+"' >"+x+"</a><a style='display:none;'>AA"+s+"</a></td><td rowspan="+(c+1)+"><a id='critsit"+s+"' tag='"+T+"'  onclick='enable(\"critsit"+s+'", "'+t[s].CommercialProductLevel2Name+'", "'+B+'","crisitColumn")\' href=\'#AA'+s+"' >"+v+"</a><a style='display:none;'>AA"+s+"</a></td><td rowspan="+(c+1)+">"+h+"</td><td rowspan="+(c+1)+">"+u+"</td><td rowspan="+(c+1)+"><a id='SV"+s+"' tag='"+T+"'  onclick='enable(\"SV"+s+'", "'+t[s].CommercialProductLevel2Name+'", "'+B+"\",\"surveyVol\")' href='javascript:void(0)' >"+r+"</a></td>",$("#TICReportTable>tbody").append(n),U+=1,i="#D3DFEE"==i?"#fff":"#D3DFEE",J+=1):(n="<tr style='background-color:"+i+"'><td rowspan="+(c+1)+">"+(s+1).toString()+"</td><td rowspan="+(c+1)+"><a id='BA"+s+"' tag='"+T+"'  href='#BB"+s+"' ><img id='imgBA"+s+"' class='TrendImage'   onclick='TrendClickEvent(\"BA"+s+'", "'+m+'" ,"'+T+'","'+C+'","'+B+'","'+g+'","'+f+'","'+k+'","'+p+'","'+x+'","'+h+'","'+u+'","'+r+"\");' /></a><a style='display:none;'>BB"+s+"</a></td><td rowspan="+(c+1)+">"+t[s].CommercialProductLevel2Name+"</td><td style='text-align:left;padding-left:20px;' rowspan="+(c+1)+">"+t[s].SupportTopicFullPath+"</td><td rowspan="+(c+1)+">"+g+"</td><td rowspan="+(c+1)+">"+f+"</td><td rowspan="+(c+1)+">"+k+"</td><td rowspan="+(c+1)+">"+p+"</td><td rowspan="+(c+1)+"><a id='AB"+s+"' tag='"+T+"'  onclick='enable(\"AB"+s+'", "'+t[s].CommercialProductLevel2Name+'", "'+B+"\")' href='#AA"+s+"' >"+x+"</a><a style='display:none;'>AA"+s+"</a></td><td rowspan="+(c+1)+"><a id='critsit"+s+"' tag='"+T+"'  onclick='enable(\"critsit"+s+'", "'+t[s].CommercialProductLevel2Name+'", "'+B+'","crisitColumn")\' href=\'#AA'+s+"' >"+v+"</a><a style='display:none;'>AA"+s+"</a></td><td rowspan="+(c+1)+">"+h+"</td><td rowspan="+(c+1)+">"+u+"</td><td rowspan="+(c+1)+"><a id='SV"+s+"' tag='"+T+"'  onclick='enable(\"SV"+s+'", "'+t[s].CommercialProductLevel2Name+'", "'+B+"\",\"surveyVol\")' href='javascript:void(0)' >"+r+"</a></td>",$("#TICReportTable>tbody").append(n)),c=0,o="",n=""}return $("#close").click(function(e){$("#trendTransition").hide(),$("#trendMask").hide()}),$("#TICReportTable").show("slow"),searchTimes=0,z&&$("#totalSTSpan").text((U-1).toString()),z&&0!=J?($("#TICReportTable").show("slow"),$("#TICReportTable2").show("slow"),void EnableViewReportButton()):($("#showData").show(),EnableViewReportButton(),$("#totalSTSpan").text(""),void $("#totalCaseSpan").text(""))})}function LoopNodes(e,t,a){var i="";return a+=1,$.each(e,function(e,n){null!=n.ChildNodes?(t=t+"<SupportLevel"+a+" id='"+n.id+"' text='"+escape(n.Text)+"' value='"+escape(n.Value)+"' showcheck='"+n.showcheck+"' complete='"+n.complete+"' checkstate='"+n.checkstate+"' isexpand='"+!0+"' hasChildren='"+n.hasChildren+"'>",i=LoopNodes(n.ChildNodes,t,a),t=i):t=t+"<SupportLevel"+a+" id='"+n.id+"' text='"+escape(n.Text)+"' value='"+escape(n.Value)+"' showcheck='"+n.showcheck+"' complete='"+n.complete+"' checkstate='"+n.checkstate+"' isexpand='"+!1+"' hasChildren='"+n.hasChildren+"'>",t=t+"</SupportLevel"+a+">",i=t}),i}function TrendClickEvent(e,t,a,i,n,o,c,d,l,s,r,h,u){$("#trendMask").css("height",$(document).height()),$("#trendMask").fadeTo(500,.25),$("#trendContent").html("<div>Loading..</div>");var g=$("#trendTransition"),m=$("#"+e).offset(),p=screen.height,v=$(document).width(),k=$(window).scrollTop();$("#trendContent").css({width:60,height:60}),$("#trendContent").css("background","#4F81BD"),g.css({top:m.top,left:m.left,display:"block"}).animate({top:p/2+k,left:v/2},600,function(){$(this).animate({top:.15*p+k,left:.2*v},600),$("#trendContent").animate({width:996.09,height:644},600,function(){showTrendingWindow(e,t,a,i,escape(n),o,c,d,l,s,r,h,u),CloseDetailsBindingTrend()})})}function RestorePageStatus(){var e=getHostUrl(),t=$("#txtPostBack").val();if("true"==t){$("#txtPostBack").val("false");var a=getUrlVars().guid;void 0===a||($("#txtGuid").val(a),$.ajax({url:e+"/RestorePageStateHandler.srv",data:{guid:a},type:"POST",cache:!1,success:function(e){var t=$.parseJSON(e);if(t.length<1)return $("#warningTitle").html("Restore Page Status :"),$("#warningText").html("No related filter info."),void $(".warning").overlay().load();$("#txtTaxonomyHidden").val(t.Taxonomy),$("#txtRegionHidden").val(t.Region),$("#txtQuaters").val(t.Quaters),$("#txtRegionDetails").val(t.Region),$("#txtCommercialProductLevel2Name").val(t.CommercialProductLevel2ID),$("#txtTimeHidden").val(t.Quaters),$("#txtProductTreeHidden").val(t.TreeID),$("#copyProductVersion").val(t.TreeID),$("#copyPESServicedID").val(t.OffTreeID),$("#txtOfferingTreeHidden").val(t.OffTreeID),$("#ProLevel1Hidden").val(t.ProductLevel1),$("#ProLevel2Hidden").val(t.ProductLevel2),$("#ProLevel3Hidden").val(t.ProductLevel3),$("#OffLevel1Hidden").val(t.OffLevel1),$("#OffLevel2Hidden").val(t.OffLevel2),$("#OffLevel3Hidden").val(t.OffLevel3);var a=t.CommercialProductLevel2ID,i=new Array;i=a.split(","),$.each(i,function(e,t){$("#"+t).attr("checked",!0),$("#Span"+t).attr("class",topIssue_checked),"ProView"==isTreeOrProView});var n=escapeText(unescape(t.TreeNodes));n=$.parseXML(n);var c=(unescape(t.TreeHtml),$(n).find("all")),d={id:c.attr("id"),Text:c.attr("text"),value:c.attr("value"),showcheck:"true"==c.attr("showcheck")?!0:!1,complete:"true"==c.attr("complete")?!0:!1,isexpand:"true"==c.attr("isexpand")?!0:!1,checkstate:c.attr("checkstate"),hasChildren:"true"==c.attr("hasChildren")?!0:!1,Level:"0"};if($(n).find("all").children().length>0){var l=CreateDataSource(d,$(n).find("all").children(),0);d.ChildNodes=l,o.data=[d],identifier=!1,$("#tree").treeview(o),$("#tree").width(parseInt(t.TreeWidth)),$("#closeTreeDiv").width(parseInt(t.TreeWidth)),$("#searchDiv").width(parseInt(t.TreeWidth)),$(".searchtextbox").width(parseInt(t.TreeWidth)-10),$("#productsNameList").width(parseInt(t.TreeWidth)),$("#calculatingDiv").width(parseInt(t.TreeWidth)),$("#tree").height(parseInt(t.TreeHeight)),$("#closeTreeDiv").height(parseInt(t.TreeHeight)+20),$("#calculatingDiv").height(parseInt(t.TreeHeight)),$("#calculatingPar").css("margin-top",(parseInt(t.TreeHeight)+28-72)/2),$("#txtProductTree").attr("value","Selected "+t.TreeItems+" items")}var s=unescape(t.OffTreeNodes);s=$.parseXML(s);var r=(unescape(t.OffTreeHtml),$(s).find("all")),h={id:r.attr("id"),Text:r.attr("text"),value:r.attr("value"),showcheck:"true"==r.attr("showcheck")?!0:!1,complete:"true"==r.attr("complete")?!0:!1,isexpand:"true"==r.attr("isexpand")?!0:!1,checkstate:r.attr("checkstate"),hasChildren:"true"==r.attr("hasChildren")?!0:!1,Level:"0"};if($(s).find("all").children().length>0){var l=CreateDataSource(h,$(s).find("all").children(),0);h.ChildNodes=l,offeringTree.data=[h],identifierForOfferingTree=!1,$("#offeringTree").offeringtreeview(offeringTree),$("#offeringTree").height(parseInt(t.OffTreeHeight)),$("#closeOfferingTreeDiv").height(parseInt(t.OffTreeHeight)+20),$("#calculatingDiv").height(parseInt(t.OffTreeHeight)),$("#offeringTree").width(parseInt(t.OffTreeWidth)),$("#closeOfferingTreeDiv").width(parseInt(t.OffTreeWidth)),$("#searchOffTrDiv").width(parseInt(t.OffTreeWidth)),$("#offTrMatchTextbox").width(parseInt(t.OffTreeWidth)-10),$("#offeringNameList").width(parseInt(t.OffTreeWidth)),$("#calculatingDiv").width(parseInt(t.OffTreeWidth)),$("#calculatingPar").css("margin-top",(parseInt(t.OffTreeHeight)+28-72)/2),$("#txtOfferingTree").attr("value","Selected "+t.OffTreeItems+" items"),offeringselectedProducts=t.OffTreeID+",",$("#txtOfferingTreeHidden").attr("value",offeringselectedProducts)}var u=unescape(t.CusRegTreeNodes);u=$.parseXML(u);var g=(unescape(t.CusRegTreeHtml),$(u).find("all")),m={id:g.attr("id"),Text:g.attr("text"),value:g.attr("value"),showcheck:"true"==g.attr("showcheck")?!0:!1,complete:"true"==g.attr("complete")?!0:!1,isexpand:"true"==g.attr("isexpand")?!0:!1,checkstate:g.attr("checkstate"),hasChildren:"true"==g.attr("hasChildren")?!0:!1,Level:"0"};if($(u).find("all").children().length>0){var l=CreateDataSource(m,$(u).find("all").children(),0);m.ChildNodes=l,cusRegionTree.data=[m],identifierForCusRegTree=!1,$("#cusRegionTree").cusRegiontreeview(cusRegionTree),$("#cusRegionTree").height(parseInt(t.CusRegTreeHeight)),$("#closecusRegionTreeDiv").height(parseInt(t.CusRegTreeHeight)+20),$("#calculatingDiv").height(parseInt(t.CusRegTreeHeight)),$("#cusRegionTree").width(parseInt(t.CusRegTreeWidth)),$("#closecusRegionTreeDiv").width(parseInt(t.CusRegTreeWidth)),$("#searchcusRegionTreeDiv").width(parseInt(t.CusRegTreeWidth)),$("#cusRegionTrMatchTextbox").width(parseInt(t.CusRegTreeWidth)-10),$("#cusRegionNamesList").width(parseInt(t.CusRegTreeWidth)),$("#calculatingDiv").width(parseInt(t.CusRegTreeWidth)),$("#calculatingPar").css("margin-top",(parseInt(t.CusRegTreeHeight)+28-72)/2),$("#txtcusRegionTree").attr("value","Selected "+t.CusRegTreeItems+" items"),cusRegionselectedProducts=t.CusRegTreeID+",",$("#txtcusRegionTreeHidden").attr("value",cusRegionselectedProducts)}var p=t.Quaters;if(""!=p){var v=new Array;v=p.split(","),$("#TimeRangeList input:checkbox").each(function(e,t){$(this).attr("checked",!1)});var k=0;$.each(v,function(e,t){$("#TimeRangeList input:checkbox").each(function(e,a){$(this).val()==t&&($(this).attr("checked",!0),k+=1)})}),k==$("#TimeRangeList input:checkbox").length?$("#txtTime").val("Selected all "+(k-1)+" items"):$("#txtTime").val("Selected "+k+" items")}var x=t.Region;if(""!=x){var f=new Array;f=x.split(","),$("#RegionList input:checkbox").each(function(e,t){$(this).attr("checked",!1)});var k=0;$.each(f,function(e,t){$("#RegionList input:checkbox").each(function(e,a){"All"==x?$(this).attr("checked",!0):$(this).val()==t&&($(this).attr("checked",!0),k+=1)})}),"All"==x?$("#txtRegion").val("Selected all items"):$("#txtRegion").val("Selected "+k+" items")}var T=t.RankType;$("#RadioFieldID10").attr("checked",!1),$("#SpanRadioFieldID10").attr("class",cluster_unchecked),$("#"+T).attr("checked",!0),$("#Span"+T).attr("class",cluster_checked);var b=t.RankValue;$("#RadioFieldID13").attr("checked",!1),$("#SpanRadioFieldID13").attr("class",cluster_unchecked),$("#"+b).attr("checked",!0),$("#Span"+b).attr("class",cluster_checked);var C=t.CritsitID;$("#filterCritsit span.clusterSelect").each(function(){$(this).attr("class",cluster_unchecked)}),$("#"+C).attr("class",cluster_checked);var L=t.AudienceView;""!=L&&($("#"+L).attr("checked",!0),$("#Span"+L).attr("class",topIssue_checked_AV)),checkedTaxonomy=t.Taxonomy,getProductInfo(),ViewReport("restore")},error:function(e){alert("error")}}))}}function getUrlVars(){for(var e,t=[],a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<a.length;i++)e=a[i].split("="),t.push(e[0]),t[e[0]]=e[1];return t}function enable(e,t,a,i){$("#detailsView").fadeOut(0);var n=$("#"+e).position();$("#txtTag").val(e),$("#detailsView").css("width",590),$(".nestedtableDiv").css("width",543),$(".nestedtableDiv").css("height",247),$("#detailsView").attr("class","org_box");var o,c,d=$("#txtQuaters").val(),l=$("#txtRegionDetails").val(),s=-1,r=$("#"+e),h=t;return s=r.attr("tag"),o=r.text(),c=o>=8?392:1>o?114:114+31*o,null==r?($("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>Support Topic ID not in line...</p>"),$("#detailsView").css("height",c)):null==s?($("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>Support Topic ID missed...</p>"),$("#detailsView").css("height",c)):"surveyVol"==i?GetDetailsViewForSurVol(d,l,s,h,c,a):GetDetailsView(d,l,s,h,c,a,i),$("#detailsView").fadeIn("slow"),"trigger active"==$(".trigger").attr("class")?$("#detailsView").css("left",n.left-955+"px"):$("#detailsView").css("left",n.left-620+"px"),$("#detailsView").css("top",n.top-10+"px"),CloseDetailsBinding(),!1}function GetDetailsView(e,t,a,i,n,o,c){$("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>Please wait...</p>"),$("#detailsView").css("height",n);var d=getHostUrl(),l=$("#copyPESServicedID").val(),s=$("#copyProductVersion").val();c||(c=""),$.post(d+"/GetTopIssueDetails.srv",{SupportTopicDerivedID:a,Quaters:e,Region:t,CommercialProductLevel2Name:s,PESServiceID:l,columnType:c},function(e){document.location.hash="?guid="+$("#txtGuid").val();var t=unescape(o).split("^"),a="";$.each(t,function(e,t){a+=t+"\\"});var i=$.parseJSON(e),c=i.length;if(1>c)return $("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>There's no details data.</p>"),$("#detailsView").css("height",n),void CloseDetailsBinding();var d=1;d=c>=8?8:c,$("#detailsView").css("height",114+31*d);for(var l="",s=0;c>s;s++){var r,h,u;r=""==$.trim(i[s].Title)?"-":len($.trim(i[s].Title))>50?len($.trim(i[s].Title))==$.trim(i[s].Title).length?$.trim(htmlEncode(i[s].Title)).substring(0,50)+"...":$.trim(htmlEncode(i[s].Title)).substring(0,25)+"...":htmlEncode(i[s].Title),h=-1==i[s].ServiceRequestNumber?NaN:i[s].ServiceRequestNumber,u=-1==i[s].CTS_TMPI?NaN:i[s].CTS_TMPI,l+="<tr><td width='6%'>"+(s+1)+"</td><td width='20%' name='ServiceRequestNumber'>"+h+"</td><td width='61%' style='text-align:left;padding-left:10px;'>"+r+"</td><td width='13%'>"+u+"</td></tr>"}$("#detailsView").html("<span class='org_box_cor cor1'></span><div class='nestedHeader'><a href='#CSTC' class='nestedFunctionFront' id='CopySR' onclick='copySR();'>Copy SR to Clipboard</a><a style='display:none;'>CSTC</a><a href='#ETE' class='nestedFunction' id='DetailsExport' >Export to Excel</a><a style='display:none;'>ETE</a><div class='triangle-down' id='closeDetails'></div><table class='headertable' id='headertable'><thead><tr class='nestedtableHeader'><td width='6%'>Rank</td><td width='20%'>Request Number</td><td width='61%'>Title</td><td width='13%'>TMPI(min)</td></tr></thead></table></div><div  class='nestedtableDiv' id='nestedtableDiv'><table class='nestedtable' id='nestedtable1'>"+l+"</table></div>"),CloseDetailsBinding(),8>=c&&$(".nestedtableDiv").css("width",538),8>d&&$(".nestedtableDiv").css("height",1+31*d),$("#nestedtable1").tableUI(),exportDetailsView();var g=$("#txtCommercialProductLevel2ID").val(),m=$("#txtQuaters").val(),p=$("#txtRegionHidden").val(),v=($("#taxonomyHidden").val(),$("#txtTaxonomyHidden").val(),$('input[type="radio"][name="rank"]:checked').val()),k="";if("proview"==isTreeOrProView.toLocaleLowerCase()){var x=$('input[type="radio"][name="av"]:checked');x.length>0&&(k=x.attr("id"))}var f=$("#ProLevel1HiddenP").val(),T=$("#ProLevel2HiddenP").val(),b=$("#ProLevel3HiddenP").val(),C=$("#OffLevel1HiddenP").val(),L=$("#OffLevel2HiddenP").val(),B=$("#OffLevel3HiddenP").val(),y=$("#CusRegLevel1HiddenP").val(),R=$("#CusRegLevel2HiddenP").val(),w=$("#CusRegLevel3HiddenP").val();SavePageStatusTopissue(g,m,"",p,v,"",k,"","","","","","",v,"Drilldown","TopIssue",isTreeOrProView,f,T,b,a,"","","","","","",C,L,B,"","","","","","",y,R,w)})}function GetDetailsViewForSurVol(e,t,a,i,n,o){$("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>Please wait...</p>"),$("#detailsView").css("height",n);var c=getHostUrl(),d=$("#copyPESServicedID").val(),l=$("#copyProductVersion").val();$.post(c+"/GetTopIssueSurveyVolDetails.srv",{SupportTopicDerivedID:a,Quaters:e,Region:t,CommercialProductLevel2Name:l,PESServiceID:d},function(e){document.location.hash="?guid="+$("#txtGuid").val();var t=unescape(o).split("^"),a="";$.each(t,function(e,t){a+=t+"\\"});var i=$.parseJSON(e),c=i.length;if(1>c)return $("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>There's no details data.</p>"),$("#detailsView").css("height",n),void CloseDetailsBinding();var d=1;d=c>=8?8:c,$("#detailsView").css("height",114+31*d);for(var l="",s=0;c>s;s++){var r,h;r=-1==i[s].ServiceRequestNumber?NaN:i[s].ServiceRequestNumber,h=i[s].Result,l+="<tr><td width='40%' name='ServiceRequestNumber'>"+r+"</td><td width='60%'>"+h+"</td></tr>"}$("#detailsView").html("<span class='org_box_cor cor1'></span><div class='nestedHeader'><a href='#CSTC' class='nestedFunctionFront' id='CopySR' onclick='copySR();'>Copy SR to Clipboard</a><a style='display:none;'>CSTC</a><a href='#ETE' class='nestedFunction' id='DetailsExport' >Export to Excel</a><a style='display:none;'>ETE</a><div class='triangle-down' id='closeDetails'></div><table class='headertable' id='headertable'><thead><tr class='nestedtableHeader'><td width='40%'>Request Number</td><td width='60%'>Result</td></tr></thead></table></div><div  class='nestedtableDiv' id='nestedtableDiv'><table class='nestedtable' id='nestedtable1'>"+l+"</table></div>"),CloseDetailsBinding(),8>=c&&$(".nestedtableDiv").css("width",538),8>d&&$(".nestedtableDiv").css("height",1+31*d),$("#nestedtable1").tableUI(),exportDetailsView();var u=$("#txtCommercialProductLevel2ID").val(),g=$("#txtQuaters").val(),m=$("#txtRegionHidden").val(),p=($("#taxonomyHidden").val(),$("#txtTaxonomyHidden").val(),$('input[type="radio"][name="rank"]:checked').val()),v="";if("proview"==isTreeOrProView.toLocaleLowerCase()){var k=$('input[type="radio"][name="av"]:checked');k.length>0&&(v=k.attr("id"))}var x=$("#ProLevel1HiddenP").val(),f=$("#ProLevel2HiddenP").val(),T=$("#ProLevel3HiddenP").val(),b=$("#OffLevel1HiddenP").val(),C=$("#OffLevel2HiddenP").val(),L=$("#OffLevel3HiddenP").val(),B=$("#CusRegLevel1HiddenP").val(),y=$("#CusRegLevel2HiddenP").val(),R=$("#CusRegLevel3HiddenP").val();SavePageStatusTopissue(u,g,"",m,p,"",v,"","","","","","",p,"DrilldownForSurVol","TopIssue",isTreeOrProView,x,f,T,a,"","","","","","",b,C,L,"","","","","","",B,y,R)})}function len(e){var t,a=0;for(i=0;i<e.length;i++){var t=e.charAt(i);a+=t.charCodeAt(0)>=128?2:1}return a}function exportDetailsView(){$("#DetailsExport").click(function(){var e=$("#DetailsExport"),t=getHostUrl();e.attr("disabled","disabled"),$.ajax({url:t+"/ExportDetailsView.srv",cache:!1,success:function(t){'"-1"'==t?($("#warningTitle").html("Export Excel Warning :"),$("#warningText").html("No data selected, please run the report first."),$(".warning").overlay().load()):'"0"'==t?($("#warningTitle").html("Export Excel Warning :"),$("#warningText").html("Report columns is 0, please run the report again."),$(".warning").overlay().load()):($("#iframe").attr("src","ExportDetailsView.srv"),$("#iframe").load()),e.removeAttr("disabled")},error:function(t){alert("error"),e.removeAttr("disabled")}})})}function DrillDownTrending(e,t,a,i,n){var o=0;$.each(a,function(e,t){parseInt(o)<parseInt(t[1])&&(o=parseInt(t[1]))}),o=parseInt(o)+5;var c=parseInt(o/5);c+=1,o=5*c,plot1=$.jqplot(e,[a],{title:t,animate:!0,animateReplot:!0,cursor:{show:!0,zoom:!0,looseZoom:!0,showTooltip:!1},axesDefaults:{},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,tickRenderer:$.jqplot.CanvasAxisTickRenderer,tickOptions:{angle:-50,fontSize:"10pt"}},yaxis:{max:o,min:0,tickInterval:c,label:n,labelRenderer:$.jqplot.CanvasAxisLabelRenderer,labelOptions:{show:!0,fontSize:"10pt"}}},seriesColors:["#4F81BD"],highlighter:{show:!0,showLabel:!0,tooltipAxes:"y",tooltipOffset:2,tooltipSeparator:"Volume:",sizeAdjust:7.5}})}function getTrendingData(e,t,a,i,n,o,c,d,l,s,r,h,u,g,m){var p=getHostUrl(),v=e,k=$("#txtRegionDetails").val(),x=$("#txtQuaters").val(),h=h,f=$("#copyPESServicedID").val(),T=$("#copyProductVersion").val(),b=$("#copyCusGeoDerivedID").val(),p=getHostUrl();$.post(p+"/GetTrendingData.srv",{supportTopicDerivedID:v,GeographyLevel3:k,Quaters:x,CommercialProductLevel2Name:T,type:h,PESServiceID:f,CustomerGeography:b},function(e){document.location.hash="?guid="+$("#txtGuid").val();var t=$.parseJSON(e),a=1;return t.length<1&&"trendingLaborCanvas"==g||!flag?($("#LaborTrending").html("<p style='color:#000000;margin-left:140px; margin-top:120px;'>There's no labor trending data.</p>"),void CloseDetailsBindingTrend()):t.length<1&&"trendingTMPICanvas"==g||!flag?($("#TMPITrending").html("<p style='color:#000000;margin-left:140px; margin-top:120px;'>There's no TMPI trending data.</p>"),void CloseDetailsBindingTrend()):t.length<1&&"trendingVolumeCanvas"==g?(flag=!1,$("#VolumeTrending").html("<p style='color:#000000;margin-left:140px; margin-top:120px;'>There's no TMPI trending data.</p>"),$("#LaborTrending").html("<p style='color:#000000;margin-left:140px; margin-top:120px;'>There's no labor trending data.</p>"),$("#TMPITrending").html("<p style='color:#000000;margin-left:140px; margin-top:120px;'>There's no TMPI trending data.</p>"),void CloseDetailsBindingTrend()):(a=t.length>6&&13>t?2:t.length>12&&25>t?4:t.length>24&&37>t?8:t.length>36&&49>t?16:32,void DrillDownTrending(g,m,t,a,u))})}function showTrendingWindow(e,t,a,i,n,o,c,d,l,s,r,h,u){if(flag=!0,null==a)$("#trendContent").html("<div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down-trend' id='closeTrend'></div></div><p style='color:#ffffff;margin-left:400px; margin-top:200px;'>There's no trending data.</p>"),CloseDetailsBindingTrend();else{var g=unescape(n).split("^"),m="";$.each(g,function(e,t){m+=t+"\\"}),t=t.replace("All,",""),m=m.substring(0,m.length-1),$("#trendContent").html("<div><div style='margin-top:5%; margin-left:3%;'><div class='triangle-down-trend' id='closeTrend'></div></div><div id='trending'>Trend Analysis</div><div class=treningDetails><table><tr><td colspan='2'><b>Support Topic:</b></td></tr><tr><td colspan='2' style='height:35px;vertical-align:top;line-height:15px'>"+m+"</td></tr><tr><td colspan='2'><b>Time Range:</b></td></tr><tr><td colspan='2' style='height:35px;vertical-align:top;line-height:15px'>"+t+"</td></tr><tr><td width='40%'><b>Labor %:</b></td><td>"+o+"</td></tr><tr><td><b>Labor Hours:</b></td><td>"+c+"</td></tr><tr><td><b>AVG TMPI:</b></td><td>"+d+"</td><tr><tr><td><b>Volume %:</b></td><td>"+l+"</td></tr><tr><td><b>Volume:</b></td><td>"+s+"</td></tr><tr><td><b>CPE TB %:</b></td><td>"+r+"</td></tr><tr><td><b>CPE BB %:</b></td><td>"+h+"</td></tr><tr><td><b>Survey Total:</b></td><td>"+u+"</td></tr></table></div><div id='trendingVolumeCanvas' class='trendingVolumeCanvas'><div id='VolumeTrending'></div></div><div id='trendingLaborCanvas' class='trendingLaborCanvas'><div id='LaborTrending'></div></div><div id='trendingTMPICanvas' class='trendingTMPICanvas'><div id='TMPITrending'></div></div></div>"),$("#VolumeTrending").html("<p style='color:#000000;margin-left:180px; margin-top:120px;'>Loading...</p><img style='color:#000000;margin-left:90px; margin-top:10px;' src='../../images/MetroLoading.gif' alt='calculating...' />"),$("#LaborTrending").html("<p style='color:#000000;margin-left:180px; margin-top:120px;'>Loading...</p><img style='color:#000000;margin-left:90px; margin-top:10px;' src='../../images/MetroLoading.gif' alt='calculating...' />"),$("#TMPITrending").html("<p style='color:#000000;margin-left:180px; margin-top:120px;'>Loading...</p><img style='color:#000000;margin-left:90px; margin-top:10px;' src='../../images/MetroLoading.gif' alt='calculating...' />"),getTrendingData(a,i,n,o,c,d,l,s,r,h,u,"TopIssue","Volume (numeric)","trendingVolumeCanvas","Volume Trend"),
getTrendingData(a,i,n,o,c,d,l,s,r,h,u,"LaborTopIssue","Labor (hours)","trendingLaborCanvas","Labor Trend"),getTrendingData(a,i,n,o,c,d,l,s,r,h,u,"TMPITopIssue","TMPI (mins)","trendingTMPICanvas","TMPI Trend")}var p=$("#txtCommercialProductLevel2ID").val(),v=$("#txtQuaters").val(),k=$("#txtRegionHidden").val(),x=($("#taxonomyHidden").val(),$("#txtTaxonomyHidden").val(),$('input[type="radio"][name="rank"]:checked').val()),f="";if("proview"==isTreeOrProView.toLocaleLowerCase()){var T=$('input[type="radio"][name="av"]:checked');T.length>0&&(f=T.attr("id"))}var b=$("#ProLevel1HiddenP").val(),C=($("#ProLevel2HiddenP").val(),$("#ProLevel3HiddenP").val()),L=$("#OffLevel1HiddenP").val(),B=$("#OffLevel2HiddenP").val(),y=$("#OffLevel3HiddenP").val(),R=$("#CusRegLevel1HiddenP").val(),w=$("#CusRegLevel2HiddenP").val(),I=$("#CusRegLevel3HiddenP").val();SavePageStatusTopissue(p,v,"",k,x,"",f,"","","","","","",x,"Trending","TopIssue",isTreeOrProView,b,i,C,m,"","","","","","",L,B,y,"","","","","","",R,w,I)}function LoadTaxonomyBasedOnTree(){var e=$("#txtProductTreeHidden").attr("value"),t=e.substring(0,e.length-1);$("#txtProductTreeHidden").attr("value",t),getProductInfo()}function ShowProductTree(){$("#searchDiv").fadeIn("slow"),$("#matchtextbox").focus(),$("#closeTreeDiv").fadeIn("slow"),$("#tree").fadeIn("slow"),$("#RegionList").hide(),$("#TimeRangeList").css("display","none"),$("#divCheckBoxList").css("display","none")}function ShowOfferingTree(){$("#searchOffTrDiv").fadeIn("slow"),$("#offTrMatchTextbox").focus(),$("#closeOfferingTreeDiv").fadeIn("slow"),$("#offeringTree").fadeIn("slow"),$("#RegionList").hide(),$("#TimeRangeList").css("display","none"),$("#divCheckBoxList").css("display","none")}function HideOfferingTree(){$("#searchOffTrDiv").hide(),$("#offeringTree").hide(),$("#closeOfferingTreeDiv").hide()}function ShowCusRegTree(){$("#searchcusRegionTreeDiv").fadeIn("slow"),$("#cusRegionTrMatchTextbox").focus(),$("#closecusRegionTreeDiv").fadeIn("slow"),$("#cusRegionTree").fadeIn("slow"),$("#RegionList").hide(),$("#TimeRangeList").css("display","none"),$("#divCheckBoxList").css("display","none")}function HideCusRegTree(){$("#searchcusRegionTreeDiv").hide(),$("#cusRegionTree").hide(),$("#closecusRegionTreeDiv").hide()}function contracts(){var e=$("#common_box"),t=e.width();350==t&&1==suspendedflag&&(e.animate({width:"35px"},500,function(){$("#content").hide()}),suspendedflag=0)}function expand(){var e=$("#common_box"),t=e.width();1==childFlag&&$("#FeedbackMask").fadeTo(500,.25),35==t&&0==suspendedflag&&($("#content").show(),e.animate({width:"350px"},500,function(){var e=$('input:radio[name="feedback"]:checked');1==currentFeedbackPageindex?LoadFeedback(currentFeedbackPageindex,5,!0,e.val()):LoadFeedback(currentFeedbackPageindex,5,!1,e.val())}),suspendedflag=1)}function checkFilter(e){var t=$('input:radio[name="feedback"]');$.each(t,function(){$(this).prop("checked",!1);var e=$(this).attr("tag");$("#"+e).css("background-color","#CD7011"),$("#"+e).css("color","#000000")}),$("#RA"+e).prop("checked",!0),$("#"+e).css("background-color","#000000"),$("#"+e).css("color","#ffffff");var a=$('input:radio[name="feedback"]:checked');$("#FeedbackMask").fadeTo(500,.25),currentFeedbackPageindex=1,LoadFeedback(1,5,!0,a.val())}function LoadFeedback(e,t,a,i){var n=getHostUrl();$.post(n+"/ViewFeedbackContent.srv",{PageIndex:e,PageSize:t,OrderType:i},function(e){var t=$.parseJSON(e);if(void 0==t.AllFeedbackContent&&65==e.length)return $(".feedbackTable").html(""),$(".feedbackTable").html("<tr><td>No feedbacks.</td></tr>"),$("#FeedbackMask").hide(),!1;var i=t.TotalFeedbackNum,n=t.TotalPageNum;a&&LoadFeedbackStructure(i,n),1==n&&($("#paging span").attr("style","margin-top:5px"),$("#paging div.short").attr("style","margin-top:15px")),2==n&&($("#paging ul li a").css("width",15),$("#paging div.short").css("margin-top",15)),n>2&&($("#paging ul li a").css("width",15),$("#paging div.short").css("margin-top",15));var o=t.AllFeedbackContent;OrganizeFeedbackCode(o)})}function LoadFeedbackStructure(e,t){$("#paging").smartpaginator({totalrecords:e,recordsperpage:5,controlsalways:!0,datacontainer:"feedbackTable",dataelement:"tr",initval:0,next:"Next",prev:"Prev",first:"First",last:"Last",theme:"mssolve",onchange:function(e){$("#FeedbackMask").fadeTo(500,.25),1==t&&($("#paging span").attr("style","margin-top:5px"),$("#paging div.short").attr("style","margin-top:15px")),2==t&&($("#paging ul li a").css("width",15),$("#paging div.short").css("margin-top",15)),t>2&&($("#paging ul li a").css("width",15),$("#paging div.short").css("margin-top",15));var a=$('input:radio[name="feedback"]:checked');currentFeedbackPageindex=e,LoadFeedback(e,5,!1,a.val())}})}function OrganizeFeedbackCode(e){for(var t="",a=0;a<e.length;a++){var i=e[a].CanVote,n="triangle-up",o="voteVolume";"0"==i&&(n="triangle-up-dis",o="voteVolumeDis");var c=e[a].FeedBackDetailsContent,d="",l="";c.length>95?(d=subString(c,95),d+="..."):d=c,l=c.replace(/'/g,""),l=l.replace(/"/g,""),l=encodeURIComponent(l),t+="<tr><td><table class='itemTable'><tr><td height='67px'  onclick='ViewCommentsByFeedbackID(\""+e[a].FeedbackID+'", 1, 3, true, "'+l+'","right", '+a+' ,"'+e[a].Alias+'", "'+e[a].CreatedTime+"\");'><div style='color:#b9a862;font-size:13px;margin-top:5px;'>"+e[a].Alias+" said:</div> <div style='color:#b9a862;font-size:13px;text-align:right;margin-top:-12px;'>"+e[a].CreatedTime+"</div><br /><span style='color:#ffffff;font-size:13px;'>"+d+"</span></td></tr><tr><td height='15px' style='border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:rgb(138,139,125);'><div class='CommentsCountDiv'  onclick='ViewCommentsByFeedbackID(\""+e[a].FeedbackID+'", 1, 3, true, "'+l+'","right", '+a+' ,"'+e[a].Alias+'", "'+e[a].CreatedTime+"\");'>Comments(<span>"+e[a].CommentsCount+"</span>)  > ></div><div class='Morefeed'><div id='voteDIV"+a+"' class='"+n+"' onclick='AddFeedbackRate(\""+e[a].FeedbackID+'", "'+e[a].Rate+'", "'+a+"\");'></div><div class='"+o+"' id='vote"+a+"'>"+e[a].Rate+"</div></div></td></tr></table></td></tr>"}$(".feedbackTable").html(""),$(".feedbackTable").html(t),$("#FeedbackMask").hide()}function ViewCommentsByFeedbackID(e,t,a,i,n,o,c,d,l){if(childFlag&&"right"==o){$("#child1").animate({marginLeft:"-320px"},500),$("#child2").animate({marginLeft:"0px"},500,function(){$("#CommentMask").fadeTo(500,.25),LoadFeedbackComments(e,t,a,!0)}),childFlag=!childFlag,$("#txtFeedbackID").val(e),$("#txtAlias").val(d);var s=$("#vote"+c).attr("class");"voteVolume"==s?($("#feedbacktriangleup").attr("class","triangle-up"),$("#feedbackvotevolume").attr("class","voteVolume")):($("#feedbacktriangleup").attr("class","triangle-up-dis"),$("#feedbackvotevolume").attr("class","voteVolumeDis")),$("#feedbackvotevolume").html(""),$("#feedbackvotevolume").html($("#vote"+c).html()),$("#feedbackusername").html(""),$("#feedbackusername").html(d),$("#feedbackdatetime").html(""),$("#feedbackdatetime").html(l),$("#feedbackcontent").html("");var r=decodeURIComponent(n);$("#feedbackcontent").html(r)}else childFlag||"left"!=o||($("#child1").animate({marginLeft:"0px"},500),$("#child2").animate({marginLeft:"330px"},500,function(){$("#FeedbackMask").fadeTo(500,.25);var e=$('input:radio[name="feedback"]:checked');LoadFeedback(currentFeedbackPageindex,5,!1,e.val())}),childFlag=!childFlag)}function LoadFeedbackComments(e,t,a,i){var n=getHostUrl();$.post(n+"/ViewFeedbackComments.srv",{FeedbackID:e,PageIndex:t,PageSize:a},function(t){var a=$.parseJSON(t);if(a.length<1)return!1;var n=a.TotalFeedbackNum,o=a.TotalPageNum;i&&LoadFeedbackCommentsStructure(e,n,o),1==o&&($("#pagingComment span").attr("style","margin-top:5px"),$("#pagingComment div.short").attr("style","margin-top:15px")),2==o&&($("#pagingComment ul li a").css("width",15),$("#pagingComment div.short").css("margin-top",15)),o>2&&($("#pagingComment ul li a").css("width",15),$("#pagingComment div.short").css("margin-top",15));var c=a.AllFeedbackComment;OrganizeFeedbackCommentsCode(c)})}function LoadFeedbackCommentsStructure(e,t,a){$("#pagingComment").smartpaginator({totalrecords:t,recordsperpage:3,controlsalways:!0,datacontainer:"commentTable",dataelement:"tr",initval:0,next:"Next",prev:"Prev",first:"First",last:"Last",theme:"mssolve",onchange:function(t){1==a&&($("#pagingComment span").attr("style","margin-top:5px"),$("#pagingComment div.short").attr("style","margin-top:15px")),2==a&&($("#pagingComment ul li a").css("width",15),$("#pagingComment div.short").css("margin-top",15)),a>2&&($("#pagingComment ul li a").css("width",15),$("#pagingComment div.short").css("margin-top",15)),currentFeedbackCommentPageIndex=t,$("#CommentMask").fadeTo(500,.25),LoadFeedbackComments(e,t,3,!1)}})}function OrganizeFeedbackCommentsCode(e){if(null==e)return $(".commentTable").html(""),$(".commentTable").html("<tr><td>No comments</td></tr>"),$("#CommentMask").hide(),!1;for(var t="",a=0;a<e.length;a++){var i=e[a].Comments;t+="<tr><td><table class='itemTable'><tr><td height='82px' style='border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:rgb(0,0,0);'><div style='color:#b9a862;font-size:13px;margin-top:2px;'>"+e[a].Alias+" said: </div><div style='color:#b9a862;font-size:13px;text-align:right;margin-top:-12px;'>("+e[a].CreatedTime+")</div><br /><textarea readonly='readonly' class='otherCommentTextarea'>"+i+"</textarea></td></tr></table></td></tr>"}$(".commentTable").html(""),$(".commentTable").html(t),$("#CommentMask").hide()}function AddFeedback(e){var t=getHostUrl();$("#FeedbackSucMask").fadeTo(500,.25),$(".FeedbackSucMaskFont").html(""),$(".FeedbackSucMaskFont").html("Sending..."),$("#sendFeedback").prop("disabled","disabled"),$.post(t+"/AddFeedBackContent.srv",{FeedBackDetailsContent:e},function(e){if("error"==e)InvokeFeedbackReminder("FeedbackSucMask","FeedbackSucMaskFont","Send Faild. Please contactTIC Team.","sendFeedback");else{InvokeFeedbackReminder("FeedbackSucMask","FeedbackSucMaskFont","Send Success.","sendFeedback"),$("#FeedbackMask").fadeTo(500,.25);var t=$('input:radio[name="feedback"]:checked');LoadFeedback(1,5,!0,t.val())}})}function InvokeFeedbackReminder(e,t,a,i){$("#"+e).fadeTo(500,.25),$("."+t).html(""),$("."+t).html(a),$("#"+i).prop("disabled","disabled"),setTimeout(function(){$("#"+e).hide(),$("#"+i).removeAttr("disabled","disabled")},2e3)}function InvokeCommentReminder(e,t,a,i){$("#"+e).fadeTo(500,.25),$("."+t).html(""),$("."+t).html(a),$("#"+i).prop("disabled","disabled"),setTimeout(function(){$("#"+e).hide(),$("#"+i).removeAttr("disabled","disabled")},2e3)}function AddFeedbackRate(e,t,a){var i=getHostUrl();$.post(i+"/AddFeedBackRate.srv",{FeedbackId:e},function(e){"error"==e?($("#warningTitle").html("Rate Feedback"),$("#warningText").html("Rate Failed. Please contact TIC team."),$(".warning").overlay().load()):"0"==e&&($("#vote"+a).html(""),$("#vote"+a).html(parseInt(t)+1),$("#vote"+a).attr("class","voteVolumeDis"),$("#voteDIV"+a).attr("class","triangle-up-dis"))})}function AddFeedbackComments(e,t,a){var i=getHostUrl();$.post(i+"/AddFeedBackComment.srv",{Comment:e,FeedBackID:t,FAlias:a},function(e){"error"==e?InvokeCommentReminder("CommentSucMask","CommentSucMaskFont","Send Faild. Please contactTIC Team.","sendComment"):(InvokeCommentReminder("CommentSucMask","CommentSucMaskFont","Send Success.","sendComment"),$("#CommentMask").fadeTo(500,.25),LoadFeedbackComments(t,1,3,!0))})}!function(e){e.fn.goTo=function(){return e("html, body").animate({scrollTop:e(this).offset().top+"px"},"slow"),this}}(jQuery);var filterDictJson,bindFlag=!1;$(document).ready(function(){function e(){var e=$(window).scrollTop();e>535?$("#TICReportTable").is(":visible")&&$("#floatHeaderDiv").show():$("#floatHeaderDiv").hide()}var t=getUrlVars().guid;$("#txtGuid").val(t),DisableViewReportButton(),$("#loadImageDiv").hide(),$("#showData").hide(),$("#floatHeaderDiv").hide(),$("#report_image").hide(),$("#reportFrame").hide(),$("#TICReportTable").hide(),AppendAll("RegionList","txtRegion","txtRegionHidden"),$("#quickTimeSelector").change(function(){var e,t=new Date,a=t.getDate(),i=t.getMonth()+1,n=t.getFullYear();10>a&&(a="0"+a),10>i&&(i="0"+i),t=i+"/"+a+"/"+n;var o=$(this).val();if("ytd"==o)$("#startDateInput").val("07/01/2012");else if("3"==o){var e=new Date(t);e.setMonth(e.getMonth()-2),$("#startDateInput").val(e.getMonth()+"/"+e.getDate()+"/"+e.getFullYear())}else if("6"==o){var e=new Date(t);e.setMonth(e.getMonth()-5),$("#startDateInput").val(e.getMonth()+"/"+e.getDate()+"/"+e.getFullYear())}}),getSupportTopicLevel2("Cloud,Dynamics,MOD,STB"),$("#cluster_Selection").change(function(){getProductInfo()}),$("#productList").change(function(){getTaxonomyInfo()}),$("#SP_Selection").change(function(){getSTL2()}),bindCrisitEvent("#filterCritsit span","#filterCritsit span.clusterSelect"),e(),$(window).scroll(e),$(window).resize(e),$("#overlay").overlay({mask:{color:"#fff",loadSpeed:200,opacity:.5},closeOnClick:!1,onBeforeClose:function(){}}),$("#close").click(function(){$("#overlay").overlay().close()}),$("#close").mousedown(function(){$("#close").attr("class","buttonClick")}),$("#close").mouseup(function(){$("#close").attr("class","metroButton")}),$("#close").mouseover(function(){$("#close").attr("class","buttonOver")}),$("#close").mouseout(function(){$("#close").attr("class","metroButton")}),CloseDetailsBinding(),$("#export").click(function(){var e=$("#export"),t=getHostUrl(),a="topissue",i=null==$("#totalSTSpan").text()?"-":$("#totalSTSpan").text(),n=null==$("#totalCaseSpan").text()?"-":$("#totalCaseSpan").text();e.attr("disabled","disabled"),$.ajax({url:t+"/ExportExcel.srv",data:{type:a,TotalSTNumber:i,TotalSRVolume:n},cache:!1,success:function(t){'"-1"'==t?($("#warningTitle").html("Export Excel Warning :"),$("#warningText").html("No data need to be exported, please view report first."),$(".warning").overlay().load()):'"0"'==t?($("#warningTitle").html("Export Excel Warning :"),$("#warningText").html("Report columns is 0, please view report again."),$(".warning").overlay().load()):($("#iframe").attr("src","ExportExcel.srv?type=topissue&TotalSTNumber="+i+"&TotalSRVolume="+n),$("#iframe").load()),e.removeAttr("disabled")},error:function(t){alert("error"),e.removeAttr("disabled")}})}),$("#viewReportLink").click(function(){ViewReport("click")}),$(".spexpandLink").live("click",function(e){$(this).hide();var t=$("#startDateInput").val(),a=$("#endDateInput").val(),i=$(this).attr("spl1"),n=$(this).attr("spl2"),o=$(this).attr("rank"),c=getHostUrl();$.post(c+"/GetContentInfo.srv",{startDate:t,endDate:a,spl1:i,spl2:n},function(e){$("#"+o+"_div").hide();for(var t=$.parseJSON(e),a=t.length,i="",n=0;a>n;n++)i=i+"<tr><td width='200px'>"+t[n].ResourceURL+"</td><td>"+t[n].LinkCount+"</td><td>"+t[n].ResourceType+"</td><td>"+t[n].OriginationMethod+"</td></tr>";var c="<table><thead><tr><td>Resource URL</td><td>Usage Count</td><td>Resouce Type</td><td>Origination Method</td></tr></thead><tbody>"+i+"</tbody></table>";$("#"+o+"_div").append(c),$("#"+o+"_div").show("slow"),$("#"+o+"_div").goTo()})});var a=new Date,i=a.getDate(),n=a.getMonth()+1,o=a.getFullYear();if(10>i&&(i="0"+i),10>n&&(n="0"+n),a=n+"/"+i+"/"+o,7>n){var c="07/01/"+(o-1);$("#startDateInput").val(c)}else{var c="07/01/"+o;$("#startDateInput").val(c)}$("#endDateInput").val(a),$("#startDateInput").datepicker({defaultDate:"+1w",changeMonth:!0,changeYear:!0,numberOfMonths:1,showAnim:"slideDown",onSelect:function(e){clearRadioButton("radio","filterForm")}}),$("#endDateInput").datepicker({defaultDate:"+1w",changeMonth:!0,changeYear:!0,numberOfMonths:1,showAnim:"slideDown",onSelect:function(e){clearRadioButton("radio","filterForm")}})}),$(window).resize(function(){var e=screen.width,t=screen.height,a=$(window).width();$(window).height();e>a?($("body").addClass("overflowHidden"),$("body").removeClass("overflowNull")):a>=e&&($("#width").addClass("widthauto"),$("body").addClass("overflowNull"),$("body").removeClass("overflowHidden")),$(".scorecardSec")&&$(".trigger").outerHeight()>t?$(".trigger").css("min-height",$(".scorecardSec").outerHeight()):$(".trigger").css("min-height",t)}),$(document).ready(function(){$(".trigger").click(function(){var e=-1;if(e=$("#txtTag").val(),-1!=e){var t=$("#"+e).position();null!=t&&"trigger active"==$(this).attr("class")}return $(".panel").toggle("slow"),$(this).toggleClass("active"),!1});var e=1349,t=$(window).width();$(window).height();e>t?($("#width").addClass("widthfix"),$("body").addClass("overflowHidden")):t>=e&&($("#width").addClass("widthauto"),$("body").addClass("overflowNull")),$(".body").css("min-height",screen.height),$(".body").css("min-width",screen.width),$(".scorecardSec")&&$(".trigger").outerHeight()>screen.height?$(".trigger").css("min-height",$(".scorecardSec").outerHeight()):$(".trigger").css("min-height",screen.height)}),$(document).ready(function(){$(".scoreCard").click(function(){$("#scoreCardContent").is(":visible")?($("#scoreCardContent").slideUp(),$(this).removeClass("active").html("+ Scorecard ")):($("#scoreCardContent").slideDown(),$(this).addClass("active").html("-  Scorecard "))}),$(".business").click(function(){$("#businessContent").is(":visible")?($("#businessContent").slideUp(),$(this).removeClass("active").html("+ Business :")):($("#businessContent").slideDown(),$(this).addClass("active").html("-  Business :"))}),$(".region").click(function(){$("#regionContent").is(":visible")?($("#regionContent").slideUp(),$(this).removeClass("active").html("+ Region :")):($("#regionContent").slideDown(),$(this).addClass("active").html("-  Region :"))}),$(".organization").click(function(){$("#organizationContent").is(":visible")?($("#organizationContent").slideUp(),$(this).removeClass("active").html("+ Organization :")):($("#organizationContent").slideDown(),$(this).addClass("active").html("-  Organization :"))}),$("a.calLnk").click(function(){$("a.calLnk").removeClass("calSelected"),$(this).addClass("calSelected")}),$("a.lnkScore").click(function(){$("a.lnkScore").css("font-weight","normal"),$(this).css("font-weight","bold")})});var successLoadOrg=function(){$("#organizationContent").slideDown(),$(".organization").addClass("active").html("-  Organization :"),$(".organization").click(function(){$("#organizationContent").is(":visible")?($("#organizationContent").slideUp(),$(this).removeClass("active").html("+ Organization :")):($("#organizationContent").slideDown(),$(this).addClass("active").html("-  Organization :"))})},successLoadCat=function(){$(document).ready(function(){$(".brandAllCat .checkbox").dgStyle(),$(".checkbox input").is(":checked")?$(".brandAllCat").css("color","#ffffff"):$(".brandAllCat").css("color","#000000")})},successLoadBusiness=function(){$("#businessContent").slideDown(),$(".business").addClass("active").html("-  Business :"),$(".business").click(function(){$("#businessContent").is(":visible")?($("#businessContent").slideUp(),$(this).removeClass("active").html("+ Business :")):($("#businessContent").slideDown(),$(this).addClass("active").html("-  Business :"))})},successLoadRegion=function(){$("#regionContent").slideDown(),$(".region").addClass("active").html("-  Region :"),$(".region").click(function(){$("#regionContent").is(":visible")?($("#regionContent").slideUp(),$(this).removeClass("active").html("+ Region :")):($("#regionContent").slideDown(),$(this).addClass("active").html("-  Region :"))})},successLoadLob=function(){$(document).ready(function(){$(".brandAllLob .checkbox").dgStyle(),$(".checkbox input").is(":checked")?$(".brandAllLob").css("color","#ffffff"):$(".brandAllLob").css("color","#000000")})};$("#LobId").click(function(){$(this).is(":checked")&&alert("checked")}),$(document).ready(function(){$("#menu").TabControl();var e="";e="False",(e="True")&&($("#scoreCardContent").text().length>0&&($("#scoreCardContent").slideDown(),$(".scoreCard").addClass("active").html("-  Scorecard ")),$("#businessContent").text().length>0&&($("#businessContent").slideDown(),$(".business").addClass("active").html("-  Business :")),$("#regionContent").text().length>0&&($("#regionContent").slideDown(),$(".region").addClass("active").html("-  Region :")),$("#organizationContent").text().length>0&&($("#organizationContent").slideDcown(),$(".organization").addClass("active").html("-  Organization :")))});var filterDictJson,divCheckBoxListHeight=0,searchTimes=0,checkedTaxonomy="",TimeFlag,t=0,flag=!0,suspendedflag=0,childFlag=!0,currentFeedbackPageindex=1;$(document).ready(function(){$("#availableS");$("#feedByTime").css("background-color","#000000"),$("#feedByTime").css("color","#ffffff"),$("#availableS").click(function(){0==suspendedflag?expand():1==suspendedflag&&contracts()}),$("#availableS").mousedown(function(){$("#availableS").attr("class","availableS-Focus")}),$("#availableS").mouseup(function(){$("#availableS").attr("class","availableS")}),$("#availableS").mouseover(function(){$("#availableS").attr("class","availableS-Focus")}),$("#availableS").mouseout(function(){$("#availableS").attr("class","availableS")}),$("#txtFeedback").focus(function(){$("#txtFeedback").attr("class","txtFeedback"),"Hi, TIC team..."==$("#txtFeedback").val()&&$("#txtFeedback").val("")}),$("#txtFeedback").focusout(function(){""==$("#txtFeedback").val()&&($("#txtFeedback").attr("class","txtFeendbackNoFocus"),$("#txtFeedback").val("Hi, TIC team..."))}),$("#txtFeedbackComment").focus(function(){$("#txtFeedbackComment").attr("class","txtFeedbackComment"),"My Comments To This FeedBack..."==$("#txtFeedbackComment").val()&&$("#txtFeedbackComment").val("")}),$("#txtFeedbackComment").focusout(function(){""==$("#txtFeedbackComment").val()&&($("#txtFeedbackComment").attr("class","txtFeedbackCommentNoFocus"),$("#txtFeedbackComment").val("My Comments To This FeedBack..."))}),$("#sendFeedback").click(function(){var e=$.trim($("#txtFeedback").val());getLen(e);""==e||0==e.length||"Hi, TIC team..."==e?InvokeFeedbackReminder("FeedbackSucMask","FeedbackSucMaskFont","Please input your feedback first, thank you.","sendFeedback"):AddFeedback(e)}),$("#sendComment").click(function(){var e=$.trim($("#txtFeedbackComment").val());getLen(e);if(""==e||0==e.length||"My Comments To This FeedBack..."==e)InvokeCommentReminder("CommentSucMask","CommentSucMaskFont","Please input your comment first, thank you.","sendComment");else{var t=$("#txtFeedbackID").val(),a=$("#txtAlias").val();AddFeedbackComments(e,t,a)}}),$("#feedByTime").click(function(){checkFilter("feedByTime")}),$("#feedByTime").mousedown(function(){$("#feedByTime").css("background-color","#000000"),$("#feedByTime").css("color","#ffffff")}),$("#feedByTime").mouseup(function(){$("#feedByTime").css("background-color","#000000"),$("#feedByTime").css("color","#ffffff")}),$("#feedByTime").mouseover(function(){$("#feedByTime").css("background-color","#000000"),$("#feedByTime").css("color","#ffffff")}),$("#feedByTime").mouseout(function(){1!=$("#RAfeedByTime").prop("checked")&&($("#feedByTime").css("background-color","#CD7011"),$("#feedByTime").css("color","#000000"))}),$("#feedByRate").click(function(){checkFilter("feedByRate")}),$("#feedByRate").mousedown(function(){$("#feedByRate").css("background-color","#000000"),$("#feedByRate").css("color","#ffffff")}),$("#feedByRate").mouseup(function(){$("#feedByRate").css("background-color","#000000"),$("#feedByRate").css("color","#ffffff")}),$("#feedByRate").mouseover(function(){$("#feedByRate").css("background-color","#000000"),$("#feedByRate").css("color","#ffffff")}),$("#feedByRate").mouseout(function(){1!=$("#RAfeedByRate").prop("checked")&&($("#feedByRate").css("background-color","#CD7011"),$("#feedByRate").css("color","#000000"))}),$("#backContent").click(function(){ViewCommentsByFeedbackID("","","","","","left")}),$("#backContent").mousedown(function(){$("#triangle-left").attr("class","triangle-left-onfocus"),$("#triangle-left-core").attr("class","triangle-left-core-onfocus")}),$("#backContent").mouseup(function(){$("#triangle-left").attr("class","triangle-left"),$("#triangle-left-core").attr("class","triangle-left-core")}),$("#backContent").mouseover(function(){$("#triangle-left").attr("class","triangle-left-onfocus"),$("#triangle-left-core").attr("class","triangle-left-core-onfocus")}),$("#backContent").mouseout(function(){$("#triangle-left").attr("class","triangle-left"),$("#triangle-left-core").attr("class","triangle-left-core")}),$("#feedbacktriangleup").click(function(){if("voteVolume"==$("#feedbackvotevolume").attr("class")){var e=$("#txtFeedbackID").val(),t=$("#feedbackvotevolume").html();AddFeedbackRate(e,t,"test"),$("#feedbackvotevolume").html(""),$("#feedbackvotevolume").html(parseInt(t)+1),$("#feedbackvotevolume").attr("class","voteVolumeDis"),$("#feedbacktriangleup").attr("class","triangle-up-dis")}})});