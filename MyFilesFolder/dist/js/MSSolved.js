function enable(e,t,a){$("#detailsView").fadeOut(0);var i=$("#"+e).position();$("#txtTag").val(e),$("#detailsView").css("width",590),$(".nestedtableDiv").css("width",543),$(".nestedtableDiv").css("height",247),$("#detailsView").attr("class","org_box");var n,o,l=$("#txtStartDate").val(),d=$("#txtEndDate").val(),s=-1,r=$("#"+e);return s=r.attr("tag"),n=r.text(),o=n>=8?392:1>n?114:114+31*n,null==r?($("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>Support Topic ID not in line...</p>"),$("#detailsView").css("height",o)):null==s?($("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>Support Topic ID missed...</p>"),$("#detailsView").css("height",o)):"ruleCounts"==a?GetDetailsViewForRuleCounts(l,d,s,o,escape(t)):"surveyVol"==a?GetDetailsViewForSurVol(l,d,s,o,escape(t)):GetDetailsView(l,d,s,o,escape(t)),$("#detailsView").fadeIn("slow"),"trigger active"==$(".trigger").attr("class")?$("#detailsView").css("left",i.left-290+"px"):$("#detailsView").css("left",i.left+40+"px"),$("#detailsView").css("top",i.top-10+"px"),CloseDetailsBinding(),!1}function GetDetailsView(e,t,a,i,n){$("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>Please wait...</p>"),$("#detailsView").css("height",i);var o=$("#copyRegion").val(),l=$("#copyProductVersion").val(),d=$("#copyPESServicedID").val(),s=getHostUrl();$.post(s+"/GetMSSolveSeamSRDetails.srv",{startDate:e,endDate:t,SupportTopicDerivedID:a,GeographyLevel3:o,productVersion:l,PESServiceID:d,Source:selectedSource},function(a){document.location.hash="?guid="+$("#txtGuid").val();var o=unescape(n).split("^"),l="";$.each(o,function(e,t){l+=t+"\\"}),l=l.substring(0,l.length-1);var d=$.parseJSON(a),s=d.length;if(1>s)return $("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>There's no details data.</p>"),$("#detailsView").css("height",i),void CloseDetailsBinding();var r=1;r=s>=8?8:s,$("#detailsView").css("height",114+31*r);for(var c="",v=0;s>v;v++){var m,g,f;m=""==$.trim(d[v].Title)?"-":len($.trim(d[v].Title))>50?len($.trim(d[v].Title))==$.trim(d[v].Title).length?$.trim(htmlEncode(d[v].Title)).substring(0,50)+"...":$.trim(htmlEncode(d[v].Title)).substring(0,25)+"...":htmlEncode(d[v].Title),g=-1==d[v].ServiceRequestNumber?NaN:d[v].ServiceRequestNumber,f=-1==d[v].CTS_TMPI?NaN:d[v].CTS_TMPI,c+="<tr><td width='6%'>"+(v+1)+"</td><td width='20%' name='ServiceRequestNumber'>"+g+"</td><td width='61%' style='text-align:left;padding-left:10px;'>"+m+"</td><td width='13%'>"+f+"</td></tr>"}$("#detailsView").html("<span class='org_box_cor cor1'></span><div class='nestedHeader'><a href='javascript:void(0)' class='nestedFunctionFront' id='CopySR' onclick='copySR();'>Copy SR to Clipboard</a><a style='display:none;'>CSTC</a><a href='javascript:void(0)' class='nestedFunction' id='DetailsExport' >Export to Excel</a><a style='display:none;'>ETE</a><div class='triangle-down' id='closeDetails'></div><table class='headertable' id='headertable'><thead><tr class='nestedtableHeader'><td width='6%'>Rank</td><td width='20%'>Request Number</td><td width='61%'>Title</td><td width='13%'>TMPI</td></tr></thead></table></div><div  class='nestedtableDiv' id='nestedtableDiv'><table class='nestedtable' id='nestedtable1'>"+c+"</table></div>"),CloseDetailsBinding(),8>=s&&$(".nestedtableDiv").css("width",538),8>r&&$(".nestedtableDiv").css("height",1+31*r),$("#nestedtable1").tableUI(),exportDetailsView();var p=$("#SP_Selection").val(),u=$("#STL2_Selection").val(),h=$('input[type="radio"][name="rank"]:checked').val(),b="";$("#SP_Selection option").each(function(){b+=$(this).val()+"^"});var k=p,T="";$("#STL2_Selection option").each(function(){T+=$(this).val()+"^"});var x=u;b=b.substring(0,b.length-1),T=T.substring(0,T.length-1);var S;S=$("#txtRegionHidden").val();var w=$("#ProLevel1HiddenP").val(),C=$("#ProLevel2HiddenP").val(),F=$("#ProLevel3HiddenP").val(),y=$("#OffLevel1HiddenP").val(),D=$("#OffLevel2HiddenP").val(),P=$("#OffLevel3HiddenP").val();SavePageStatus(e,t,"","","","","","","",b,k,T,x,S,"","",h,"","Drilldown","MSSolve",w,C,F,l,"","","","","","",y,D,P)})}function GetDetailsViewForSurVol(e,t,a,i,n){$("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>Please wait...</p>"),$("#detailsView").css("height",i);var o=$("#copyRegion").val(),l=$("#copyProductVersion").val(),d=$("#copyPESServicedID").val(),s=getHostUrl();$.post(s+"/GetMSSolveSeamSurveyVolDetails.srv",{startDate:e,endDate:t,SupportTopicDerivedID:a,GeographyLevel3:o,productVersion:l,PESServiceID:d,Source:selectedSource},function(a){document.location.hash="?guid="+$("#txtGuid").val();var o=unescape(n).split("^"),l="";$.each(o,function(e,t){l+=t+"\\"});var d=$.parseJSON(a),s=d.length;if(1>s)return $("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>There's no details data.</p>"),$("#detailsView").css("height",i),void CloseDetailsBinding();var r=1;r=s>=8?8:s,$("#detailsView").css("height",114+31*r);for(var c="",v=0;s>v;v++){var m,g;m=-1==d[v].ServiceRequestNumber?NaN:d[v].ServiceRequestNumber,g=d[v].Result,c+="<tr><td width='40%' name='ServiceRequestNumber'>"+m+"</td><td width='60%'>"+g+"</td></tr>"}$("#detailsView").html("<span class='org_box_cor cor1'></span><div class='nestedHeader'><a href='#CSTC' class='nestedFunctionFront' id='CopySR' onclick='copySR();'>Copy SR to Clipboard</a><a style='display:none;'>CSTC</a><a href='#ETE' class='nestedFunction' id='DetailsExport' >Export to Excel</a><a style='display:none;'>ETE</a><div class='triangle-down' id='closeDetails'></div><table class='headertable' id='headertable'><thead><tr class='nestedtableHeader'><td width='40%'>Request Number</td><td width='60%'>Result</td></tr></thead></table></div><div  class='nestedtableDiv' id='nestedtableDiv'><table class='nestedtable' id='nestedtable1'>"+c+"</table></div>"),CloseDetailsBinding(),8>=s&&$(".nestedtableDiv").css("width",538),8>r&&$(".nestedtableDiv").css("height",1+31*r),$("#nestedtable1").tableUI(),exportDetailsView();var f=$("#SP_Selection").val(),p=$("#STL2_Selection").val(),u=$('input[type="radio"][name="rank"]:checked').val(),h="";$("#SP_Selection option").each(function(){h+=$(this).val()+"^"});var b=f,k="";$("#STL2_Selection option").each(function(){k+=$(this).val()+"^"});var T=p;h=h.substring(0,h.length-1),k=k.substring(0,k.length-1);var x;x=$("#txtRegionHidden").val();var S=$("#ProLevel1HiddenP").val(),w=$("#ProLevel2HiddenP").val(),C=$("#ProLevel3HiddenP").val(),F=$("#OffLevel1HiddenP").val(),y=$("#OffLevel2HiddenP").val(),D=$("#OffLevel3HiddenP").val();SavePageStatus(e,t,"","","","","","","",h,b,k,T,x,"","",u,"","DrilldownForSurVol","MSSolve",S,w,C,l,"","","","","","",F,y,D)})}function GetDetailsViewForRuleCounts(e,t,a,i,n){$("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>Please wait...</p>"),$("#detailsView").css("height",i);var o=getHostUrl();$.post(o+"/GetMSSolveRuleCountsDetails.srv",{startDate:e,endDate:t,SupportTopicDerivedID:a},function(a){document.location.hash="?guid="+$("#txtGuid").val();var o=unescape(n).split("^"),l="";$.each(o,function(e,t){l+=t+"\\"}),l=l.substring(0,l.length-1);var d=$.parseJSON(a),s=d.length;if($("#detailsView").width(670),1>s)return $("#detailsView").html("<span class='org_box_cor cor1'></span><div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down' id='closeDetails'></div></div><p style='text-align:center; vertical-align:middle; color:#ffffff'>There's no details data.</p>"),$("#detailsView").css("height",i),void CloseDetailsBinding();var r=1;r=s>=8?8:s,$("#detailsView").css("height",114+31*r);for(var c="",v=0;s>v;v++){var m,g,f,p,u,h;m=""==$.trim(d[v].Title)?"-":len($.trim(d[v].Title))>40?len($.trim(d[v].Title))==$.trim(d[v].Title).length?$.trim(htmlEncode(d[v].Title)).substring(0,50)+"...":$.trim(htmlEncode(d[v].Title)).substring(0,25)+"...":htmlEncode(d[v].Title),g=""==d[v].Author?"-":d[v].Author,f=-1==d[v].ViewedPer?"-":d[v].ViewedPer.toFixed(1)+"%",p=-1==d[v].HelpPer?"-":d[v].HelpPer.toFixed(1)+"%",u=-1==d[v].NotHelpPer?"-":d[v].NotHelpPer.toFixed(1)+"%",h=-1==d[v].ResponsePer?"-":d[v].ResponsePer.toFixed(1)+"%",c+="<tr><td width='52%' style='text-align:left;'>"+m+"</td><td width='10.5%' name='ServiceRequestNumber'>"+g+"</td><td width='9%' >"+f+"</td><td width='7%'>"+p+"</td><td width='10.5%'>"+u+"</td><td width='11%'>"+h+"</td></tr>"}$("#detailsView").html("<span class='org_box_cor cor1'></span><div class='nestedHeader'><a href='javascript:void(0)' class='nestedFunctionFront' id='CopySR' onclick='copySR();'>Copy Titles to Clipboard</a><a style='display:none;'>CSTC</a><a href='javascript:void(0)' class='nestedFunction' id='DetailsExport' >Export to Excel</a><a style='display:none;'>ETE</a><div class='triangle-down' id='closeDetails' style='margin-left:595px'></div><table class='headertable' id='headertable'></table></div><div  class='nestedtableDiv' id='nestedtableDiv' style='height:280px;width:630px'><table class='nestedtable' id='nestedtable1' ><thead ><tr class='headertable nestedtableHeader' style='background-color:rgb(0, 0, 60);'><td width='55%'>Title</td><td width='13%'>Author</td><td width='8%'>Viewed%</td><td width='8%'>Help%</td><td width='8%'>NotHelp%</td><td width='8%'>Response%</td></tr></thead>"+c+"</table></div>"),CloseDetailsBinding(),8>=s&&$(".nestedtableDiv").css("width",538),8>r&&$(".nestedtableDiv").css("height",1+31*(r+1)),$("#nestedtable1").tableUI(),exportDetailsView();var b=$("#SP_Selection").val(),k=$("#STL2_Selection").val(),T=$('input[type="radio"][name="rank"]:checked').val(),x="";$("#SP_Selection option").each(function(){x+=$(this).val()+"^"});var S=b,w="";$("#STL2_Selection option").each(function(){w+=$(this).val()+"^"});var C=k;x=x.substring(0,x.length-1),w=w.substring(0,w.length-1);var F;F=$("#txtRegionHidden").val();var y=$("#ProLevel1HiddenP").val(),D=$("#ProLevel2HiddenP").val(),P=$("#ProLevel3HiddenP").val(),I=$("#OffLevel1HiddenP").val(),L=$("#OffLevel2HiddenP").val(),R=$("#OffLevel3HiddenP").val();SavePageStatus(e,t,"","","","","","","",x,S,w,C,F,"","",T,"","DrilldownForRuleCounts","MSSolve",y,D,P,l,"","","","","","",I,L,R)})}function len(e){var t,a=0;for(i=0;i<e.length;i++){var t=e.charAt(i);a+=t.charCodeAt(0)>=128?2:1}return a}function exportDetailsView(){$("#DetailsExport").click(function(){var e=$("#DetailsExport"),t=getHostUrl();e.attr("disabled","disabled"),$.ajax({url:t+"/ExportDetailsView.srv",cache:!1,success:function(t){'"-1"'==t?($("#warningTitle").html("Export Excel Warning :"),$("#warningText").html("No data need to be exported, please view report first."),$(".warning").overlay().load()):'"0"'==t?($("#warningTitle").html("Export Excel Warning :"),$("#warningText").html("Report columns is 0, please view report again."),$(".warning").overlay().load()):($("#iframe").attr("src","ExportDetailsView.srv"),$("#iframe").load()),e.removeAttr("disabled")},error:function(t){alert("error"),e.removeAttr("disabled")}})})}function AppendAll(e,t,a){if($("#"+e+" input:checkbox:first").attr("checked")){var i=0,n="";$("#"+e+" input:checkbox").each(function(e,t){$(this).attr("checked",!0),i+=1,n+=$(this).val()+","}),"txtRegionHidden"==a&&(n="All"),$("#"+a).attr("value",n),i-=1,$("#"+t).get(0).value="Selected all "+i+" items"}else $("#"+e+" input:checkbox").each(function(e,t){$(this).attr("checked",!1)}),$("#"+t).get(0).value="Selected 0 item",ClearSelectedItems(a)}function AppendCheckBoxInfo(e,t,a){count=$("#"+e+" input:checkbox").get().length-1;var i=0,n="",o="";$("#"+e+" input:checkbox[value!='All']:checked").each(function(){n+=$(this).val()+",",i+=1}),n=n.substring(0,n.length-1),$("#"+a).attr("value",n),i==count&&($("#"+e+" input:checkbox:first").attr("checked",!0),o="Selected all "+i+" items","txtRegionHidden"==a&&$("#"+a).attr("value","All")),i<count&&($("#"+e+" input:checkbox:first").attr("checked",!1),o=1==i?"Selected "+i+" item":"Selected "+i+" items"),0==i&&($("#"+e+" input:checkbox:first").attr("checked",!1),o="Selected 0 item"),$("#"+t).attr("value",o)}function ClearSelectedItems(e){$("#"+e).attr("value","")}function UpdateTableHeaders(){var e=$(window).scrollTop();$("#floatHeaderDiv").height();e>535?$("#TICReportTable").is(":visible")&&($("#floatHeaderDiv").show(),$("#supportTopicTreeDiv").css("top",20),$("#supportTopicTreeDiv").css("position","fixed")):($("#floatHeaderDiv").hide(),$("#supportTopicTreeDiv").css("top",385),$("#supportTopicTreeDiv").css("position","absolute"))}function DrillDownTrending(e,t,a,i,n){var o=a[0][0];a.shift();var l=0;$.each(a,function(e,t){parseInt(l)<parseInt(t[1])&&(l=parseInt(t[1]))}),l=parseInt(l)+5;var d=parseInt(l/5);d+=1,l=5*d,plot1=$.jqplot(e,[a],{title:t,animate:!0,animateReplot:!0,cursor:{show:!0,zoom:!0,looseZoom:!0,showTooltip:!1},axesDefaults:{},axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer,min:o,tickInterval:i,tickRenderer:$.jqplot.CanvasAxisTickRenderer,tickOptions:{angle:-50,fontSize:"10pt"}},yaxis:{max:l,min:0,tickInterval:d,autoscale:!0,label:n,labelRenderer:$.jqplot.CanvasAxisLabelRenderer,labelOptions:{show:!0,fontSize:"10pt"}}},seriesColors:["#40B677"],highlighter:{show:!0,showLabel:!0,tooltipAxes:"both",tooltipOffset:2,tooltipSeparator:", Volume: ",sizeAdjust:7.5}})}function getTrendingData(e,t,a,i,n,o,l,d,s,r,c,v,m,g){var f=getHostUrl(),p=$("#trendStartDate").val(),u=$("#txtEndDate").val(),h=e,b=$("#copyRegion").val(),k=$("#copyProductVersion").val(),T=$("#copyPESServicedID").val(),c=c;$.post(f+"/GetTrendingData.srv",{startDate:p,endDate:u,supportTopicDerivedID:h,GeographyLevel3:b,productVersion:k,type:c,PESServiceID:T},function(e){document.location.hash="?guid="+$("#txtGuid").val();var t=$.parseJSON(e);if(t.length<1&&"trendingLaborCanvas"==m||!flag)return $("#LaborTrending").html("<p style='color:#000000;margin-left:140px; margin-top:120px;'>There's no labor trending data.</p>"),void CloseDetailsBindingTrend();if(t.length<1&&"trendingTMPICanvas"==m||!flag)return $("#TMPITrending").html("<p style='color:#000000;margin-left:140px; margin-top:120px;'>There's no TMPI trending data.</p>"),void CloseDetailsBindingTrend();if(t.length<1&&"trendingVolumeCanvas"==m)return flag=!1,$("#VolumeTrending").html("<p style='color:#000000;margin-left:140px; margin-top:120px;'>There's no TMPI trending data.</p>"),$("#LaborTrending").html("<p style='color:#000000;margin-left:140px; margin-top:120px;'>There's no labor trending data.</p>"),$("#TMPITrending").html("<p style='color:#000000;margin-left:140px; margin-top:120px;'>There's no TMPI trending data.</p>"),void CloseDetailsBindingTrend();var a=t[0][1];DrillDownTrending(m,g,t,a,v)})}function showTrendingWindow(e,t,a,i,n,o,l,d,s,r,c,v){if(flag=!0,null==a)$("#trendContent").html("<div style='margin-top:7.5%; margin-left:3%;'><div class='triangle-down-trend' id='closeTrend'></div></div><p style='color:#ffffff;margin-left:400px; margin-top:200px;'>There's no trending data.</p>"),CloseDetailsBindingTrend();else{var m=unescape(i).split("^"),g="";$.each(m,function(e,t){g+=t+"\\"}),g=g.substring(0,g.length-1),$("#trendContent").html("<div><div style='margin-top:5%; margin-left:3%;'><div class='triangle-down-trend' id='closeTrend'></div></div><div id='trending'>Trend Analysis</div><div class=treningDetails><table><tr><td colspan='2'><b>Support Topic:</b></td></tr><tr><td colspan='2' style='height:45px;vertical-align:top;line-height:15px'>"+g+"</td></tr><tr><td width='50%'><b>Time Range:</b></td><td>"+t+"</td></tr><tr><td><b>Labor %:</b></td><td>"+n+"</td></tr><tr><td><b>Labor Hours:</b></td><td>"+o+"</td></tr><tr><td><b>AVG TMPI:</b></td><td>"+l+"</td><tr><tr><td><b>Volume %:</b></td><td>"+d+"</td></tr><tr><td><b>Volume:</b></td><td>"+s+"</td></tr><tr><td><b>CPE TB %:</b></td><td>"+r+"</td></tr><tr><td><b>CPE BB %:</b></td><td>"+c+"</td></tr><tr><td><b>Survey Total:</b></td><td>"+v+"</td></tr></table></div><div id='trendingVolumeCanvas' class='trendingVolumeCanvas'><div id='VolumeTrending'></div></div><div id='trendingLaborCanvas' class='trendingLaborCanvas'><div id='LaborTrending'></div></div><div id='trendingTMPICanvas' class='trendingTMPICanvas'><div id='TMPITrending'></div></div></div>"),$("#VolumeTrending").html("<p style='color:#000000;margin-left:180px; margin-top:120px;'>Loading...</p><img style='color:#000000;margin-left:90px; margin-top:10px;' src='../../images/MetroLoading.gif' alt='calculating...' />"),$("#LaborTrending").html("<p style='color:#000000;margin-left:180px; margin-top:120px;'>Loading...</p><img style='color:#000000;margin-left:90px; margin-top:10px;' src='../../images/MetroLoading.gif' alt='calculating...' />"),$("#TMPITrending").html("<p style='color:#000000;margin-left:180px; margin-top:120px;'>Loading...</p><img style='color:#000000;margin-left:90px; margin-top:10px;' src='../../images/MetroLoading.gif' alt='calculating...' />"),getTrendingData(a,i,n,o,l,d,s,r,c,v,"NotTopIssue","Volume (numeric)","trendingVolumeCanvas","Volume Trend"),getTrendingData(a,i,n,o,l,d,s,r,c,v,"LaborNotTopIssue","Labor (hours)","trendingLaborCanvas","Labor Trend"),getTrendingData(a,i,n,o,l,d,s,r,c,v,"TMPINotTopIssue","TMPI (mins)","trendingTMPICanvas","TMPI Trend");var f=$("#txtStartDate").val(),p=$("#txtEndDate").val(),u=$("#SP_Selection").val(),h=$("#STL2_Selection").val(),b=$('input[type="radio"][name="rank"]:checked').val(),k="";$("#SP_Selection option").each(function(){k+=$(this).val()+"^"});var T=u,x="";$("#STL2_Selection option").each(function(){x+=$(this).val()+"^"});var S=h;k=k.substring(0,k.length-1),x=x.substring(0,x.length-1);var w;w=$("#txtRegionHidden").val();var C=$("#ProLevel1HiddenP").val(),F=$("#ProLevel2HiddenP").val(),y=$("#ProLevel3HiddenP").val(),D=$("#OffLevel1HiddenP").val(),P=$("#OffLevel2HiddenP").val(),I=$("#OffLevel3HiddenP").val();SavePageStatus(f,p,"","","","","","","",k,T,x,S,w,"","",b,"","Trending","MSSolve",C,F,y,g,"","","","","","",D,P,I),CloseDetailsBindingTrend()}}function TrendClickEvent(e,t,a,i,n,o,l,d,s,r,c,v){$("#trendMask").css("height",$(document).height()),$("#trendMask").fadeTo(500,.25),$("#trendContent").html("<div>Loading..</div>");var m=$("#trendTransition"),g=$("#"+e).offset(),f=screen.height,p=$(document).width(),u=$(window).scrollTop();$("#trendContent").css({width:60,height:60}),$("#trendContent").css("background","#40B677"),m.css({top:g.top,left:g.left,display:"block"}).animate({top:f/2+u,left:p/2},600,function(){$(this).animate({top:.15*f+u,left:.2*p},600),$("#trendContent").animate({width:996.09,height:644},600,function(){showTrendingWindow(e,t,a,escape(i),n,o,l,d,s,r,c,v),CloseDetailsBindingTrend()})})}function LoadTaxonomyBasedOnTree(){$("#SP_Selection").attr("disabled",!0),$("#STL2_Selection").attr("disabled",!0);var e=$("#txtProductTreeHidden").attr("value"),t=e.substring(0,e.length-1);$("#okProductTreeHidden").attr("value",t),getProductInfo(),$("#tree").fadeOut(),$("#searchDiv").fadeOut(),$("#productsNameList span").html(""),$("#productsNameList").attr("class",""),$("#closeTreeDiv").fadeOut()}function ShowProductTree(){$("#searchDiv").fadeIn("slow"),$("#matchtextbox").focus(),$("#closeTreeDiv").fadeIn("slow"),$("#tree").fadeIn("slow"),$("#RegionList").hide()}function ShowOfferingTree(){$("#searchOffTrDiv").fadeIn("slow"),$("#offTrMatchTextbox").focus(),$("#closeOfferingTreeDiv").fadeIn("slow"),$("#offeringTree").fadeIn("slow"),$("#RegionList").hide(),$("#TimeRangeList").css("display","none"),$("#divCheckBoxList").css("display","none")}function HideOfferingTree(){$("#searchOffTrDiv").hide(),$("#offeringTree").hide(),$("#closeOfferingTreeDiv").hide()}function ShowRegion(){$("#RegionList").slideDown(),$("#searchDiv").fadeOut("slow"),$("#tree").fadeOut("slow"),$("#closeTreeDiv").fadeOut("slow")}function CloseSupTopTree(){$("#supportTopicTreeDiv").fadeOut("slow")}function contracts(){var e=$("#common_box"),t=e.width();350==t&&1==suspendedflag&&(e.animate({width:"35px"},500,function(){$("#content").hide()}),suspendedflag=0)}function expand(){var e=$("#common_box"),t=e.width();1==childFlag&&$("#FeedbackMask").fadeTo(500,.25),35==t&&0==suspendedflag&&($("#content").show(),e.animate({width:"350px"},500,function(){var e=$('input:radio[name="feedback"]:checked');1==currentFeedbackPageindex?LoadFeedback(currentFeedbackPageindex,5,!0,e.val()):LoadFeedback(currentFeedbackPageindex,5,!1,e.val())}),suspendedflag=1)}function checkFilter(e){var t=$('input:radio[name="feedback"]');$.each(t,function(){$(this).prop("checked",!1);var e=$(this).attr("tag");$("#"+e).css("background-color","#CD7011"),$("#"+e).css("color","#000000")}),$("#RA"+e).prop("checked",!0),$("#"+e).css("background-color","#000000"),$("#"+e).css("color","#ffffff");var a=$('input:radio[name="feedback"]:checked');$("#FeedbackMask").fadeTo(500,.25),currentFeedbackPageindex=1,LoadFeedback(1,5,!0,a.val())}function LoadFeedback(e,t,a,i){var n=getHostUrl();$.post(n+"/ViewFeedbackContent.srv",{PageIndex:e,PageSize:t,OrderType:i},function(e){var t=$.parseJSON(e);if(void 0==t.AllFeedbackContent&&65==e.length)return $(".feedbackTable").html(""),$(".feedbackTable").html("<tr><td>No feedbacks.</td></tr>"),$("#FeedbackMask").hide(),!1;var i=t.TotalFeedbackNum,n=t.TotalPageNum;a&&LoadFeedbackStructure(i,n),1==n&&($("#paging span").attr("style","margin-top:5px"),$("#paging div.short").attr("style","margin-top:15px")),2==n&&($("#paging ul li a").css("width",15),$("#paging div.short").css("margin-top",15)),n>2&&($("#paging ul li a").css("width",15),$("#paging div.short").css("margin-top",15));var o=t.AllFeedbackContent;OrganizeFeedbackCode(o)})}function LoadFeedbackStructure(e,t){$("#paging").smartpaginator({totalrecords:e,recordsperpage:5,controlsalways:!0,datacontainer:"feedbackTable",dataelement:"tr",initval:0,next:"Next",prev:"Prev",first:"First",last:"Last",theme:"mssolve",onchange:function(e){$("#FeedbackMask").fadeTo(500,.25),1==t&&($("#paging span").attr("style","margin-top:5px"),$("#paging div.short").attr("style","margin-top:15px")),2==t&&($("#paging ul li a").css("width",15),$("#paging div.short").css("margin-top",15)),t>2&&($("#paging ul li a").css("width",15),$("#paging div.short").css("margin-top",15));var a=$('input:radio[name="feedback"]:checked');currentFeedbackPageindex=e,LoadFeedback(e,5,!1,a.val())}})}function OrganizeFeedbackCode(e){for(var t="",a=0;a<e.length;a++){var i=e[a].CanVote,n="triangle-up",o="voteVolume";"0"==i&&(n="triangle-up-dis",o="voteVolumeDis");var l=e[a].FeedBackDetailsContent,d="",s="";l.length>95?(d=subString(l,95),d+="..."):d=l,s=l.replace(/'/g,""),s=s.replace(/"/g,""),s=encodeURIComponent(s),t+="<tr><td><table class='itemTable'><tr><td height='67px'  onclick='ViewCommentsByFeedbackID(\""+e[a].FeedbackID+'", 1, 3, true, "'+s+'","right", '+a+' ,"'+e[a].Alias+'", "'+e[a].CreatedTime+"\");'><div style='color:#b9a862;font-size:13px;margin-top:5px;'>"+e[a].Alias+" said:</div> <div style='color:#b9a862;font-size:13px;text-align:right;margin-top:-12px;'>"+e[a].CreatedTime+"</div><br /><span style='color:#ffffff;font-size:13px;'>"+d+"</span></td></tr><tr><td height='15px' style='border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:rgb(138,139,125);'><div class='CommentsCountDiv'  onclick='ViewCommentsByFeedbackID(\""+e[a].FeedbackID+'", 1, 3, true, "'+s+'","right", '+a+' ,"'+e[a].Alias+'", "'+e[a].CreatedTime+"\");'>Comments(<span>"+e[a].CommentsCount+"</span>)  > ></div><div class='Morefeed'><div id='voteDIV"+a+"' class='"+n+"' onclick='AddFeedbackRate(\""+e[a].FeedbackID+'", "'+e[a].Rate+'", "'+a+"\");'></div><div class='"+o+"' id='vote"+a+"'>"+e[a].Rate+"</div></div></td></tr></table></td></tr>"}$(".feedbackTable").html(""),$(".feedbackTable").html(t),$("#FeedbackMask").hide()}function ViewCommentsByFeedbackID(e,t,a,i,n,o,l,d,s){if(childFlag&&"right"==o){$("#child1").animate({marginLeft:"-320px"},500),$("#child2").animate({marginLeft:"0px"},500,function(){$("#CommentMask").fadeTo(500,.25),LoadFeedbackComments(e,t,a,!0)}),childFlag=!childFlag,$("#txtFeedbackID").val(e),$("#txtAlias").val(d);var r=$("#vote"+l).attr("class");"voteVolume"==r?($("#feedbacktriangleup").attr("class","triangle-up"),$("#feedbackvotevolume").attr("class","voteVolume")):($("#feedbacktriangleup").attr("class","triangle-up-dis"),$("#feedbackvotevolume").attr("class","voteVolumeDis")),$("#feedbackvotevolume").html(""),$("#feedbackvotevolume").html($("#vote"+l).html()),$("#feedbackusername").html(""),$("#feedbackusername").html(d),$("#feedbackdatetime").html(""),$("#feedbackdatetime").html(s),$("#feedbackcontent").html("");var c=decodeURIComponent(n);$("#feedbackcontent").html(c)}else childFlag||"left"!=o||($("#child1").animate({marginLeft:"0px"},500),$("#child2").animate({marginLeft:"330px"},500,function(){$("#FeedbackMask").fadeTo(500,.25);var e=$('input:radio[name="feedback"]:checked');LoadFeedback(currentFeedbackPageindex,5,!1,e.val())}),childFlag=!childFlag)}function LoadFeedbackComments(e,t,a,i){var n=getHostUrl();$.post(n+"/ViewFeedbackComments.srv",{FeedbackID:e,PageIndex:t,PageSize:a},function(t){var a=$.parseJSON(t);if(a.length<1)return!1;var n=a.TotalFeedbackNum,o=a.TotalPageNum;i&&LoadFeedbackCommentsStructure(e,n,o),1==o&&($("#pagingComment span").attr("style","margin-top:5px"),$("#pagingComment div.short").attr("style","margin-top:15px")),2==o&&($("#pagingComment ul li a").css("width",15),$("#pagingComment div.short").css("margin-top",15)),o>2&&($("#pagingComment ul li a").css("width",15),$("#pagingComment div.short").css("margin-top",15));var l=a.AllFeedbackComment;OrganizeFeedbackCommentsCode(l)})}function LoadFeedbackCommentsStructure(e,t,a){$("#pagingComment").smartpaginator({totalrecords:t,recordsperpage:3,controlsalways:!0,datacontainer:"commentTable",dataelement:"tr",initval:0,next:"Next",prev:"Prev",first:"First",last:"Last",theme:"mssolve",onchange:function(t){1==a&&($("#pagingComment span").attr("style","margin-top:5px"),$("#pagingComment div.short").attr("style","margin-top:15px")),2==a&&($("#pagingComment ul li a").css("width",15),$("#pagingComment div.short").css("margin-top",15)),a>2&&($("#pagingComment ul li a").css("width",15),$("#pagingComment div.short").css("margin-top",15)),currentFeedbackCommentPageIndex=t,$("#CommentMask").fadeTo(500,.25),LoadFeedbackComments(e,t,3,!1)}})}function OrganizeFeedbackCommentsCode(e){if(null==e)return $(".commentTable").html(""),$(".commentTable").html("<tr><td>No comments</td></tr>"),$("#CommentMask").hide(),!1;for(var t="",a=0;a<e.length;a++){var i=e[a].Comments;t+="<tr><td><table class='itemTable'><tr><td height='82px' style='border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:rgb(0,0,0);'><div style='color:#b9a862;font-size:13px;margin-top:2px;'>"+e[a].Alias+" said: </div><div style='color:#b9a862;font-size:13px;text-align:right;margin-top:-12px;'>("+e[a].CreatedTime+")</div><br /><textarea  readonly='readonly' class='otherCommentTextarea'>"+i+"</textarea></td></tr></table></td></tr>"}$(".commentTable").html(""),$(".commentTable").html(t),$("#CommentMask").hide()}function AddFeedback(e){var t=getHostUrl();$("#FeedbackSucMask").fadeTo(500,.25),$(".FeedbackSucMaskFont").html(""),$(".FeedbackSucMaskFont").html("Sending..."),$("#sendFeedback").prop("disabled","disabled"),$.post(t+"/AddFeedBackContent.srv",{FeedBackDetailsContent:e},function(e){if("error"==e)InvokeFeedbackReminder("FeedbackSucMask","FeedbackSucMaskFont","Send Faild. Please contactTIC Team.","sendFeedback");else{InvokeFeedbackReminder("FeedbackSucMask","FeedbackSucMaskFont","Send Success.","sendFeedback"),$("#FeedbackMask").fadeTo(500,.25);var t=$('input:radio[name="feedback"]:checked');LoadFeedback(1,5,!0,t.val())}})}function InvokeFeedbackReminder(e,t,a,i){$("#"+e).fadeTo(500,.25),$("."+t).html(""),$("."+t).html(a),$("#"+i).prop("disabled","disabled"),setTimeout(function(){$("#"+e).hide(),$("#"+i).removeAttr("disabled","disabled")},2e3)}function InvokeCommentReminder(e,t,a,i){$("#"+e).fadeTo(500,.25),$("."+t).html(""),$("."+t).html(a),$("#"+i).prop("disabled","disabled"),setTimeout(function(){$("#"+e).hide(),$("#"+i).removeAttr("disabled","disabled")},2e3)}function AddFeedbackRate(e,t,a){var i=getHostUrl();$.post(i+"/AddFeedBackRate.srv",{FeedbackId:e},function(e){"error"==e?($("#warningTitle").html("Rate Feedback"),$("#warningText").html("Rate Failed. Please contact TIC team."),$(".warning").overlay().load()):"0"==e&&($("#vote"+a).html(""),$("#vote"+a).html(parseInt(t)+1),$("#vote"+a).attr("class","voteVolumeDis"),$("#voteDIV"+a).attr("class","triangle-up-dis"))})}function AddFeedbackComments(e,t,a){var i=getHostUrl();$.post(i+"/AddFeedBackComment.srv",{Comment:e,FeedBackID:t,FAlias:a},function(e){"error"==e?InvokeCommentReminder("CommentSucMask","CommentSucMaskFont","Send Faild. Please contactTIC Team.","sendComment"):(InvokeCommentReminder("CommentSucMask","CommentSucMaskFont","Send Success.","sendComment"),$("#CommentMask").fadeTo(500,.25),LoadFeedbackComments(t,1,3,!0))})}$(document).ready(function(){}),$(document).ready(function(){AppendAll("RegionList","txtRegion","txtRegionHidden")}),$(document).ready(function(){SetxmlString01(),SetXmlString(),SetXmlStringForOfferingTree("NonTopIssueGBS")}),UpdateTableHeaders(),$(window).scroll(UpdateTableHeaders),$(window).resize(UpdateTableHeaders);var flag=!0,suspendedflag=0,childFlag=!0,currentFeedbackPageindex=1;$(document).ready(function(){$("#availableS");$("#feedByTime").css("background-color","#000000"),$("#feedByTime").css("color","#ffffff"),$("#availableS").click(function(){0==suspendedflag?expand():1==suspendedflag&&contracts()}),$("#availableS").mousedown(function(){$("#availableS").attr("class","availableS-Focus")}),$("#availableS").mouseup(function(){$("#availableS").attr("class","availableS")}),$("#availableS").mouseover(function(){$("#availableS").attr("class","availableS-Focus")}),$("#availableS").mouseout(function(){$("#availableS").attr("class","availableS")}),$("#txtFeedback").focus(function(){$("#txtFeedback").attr("class","txtFeedback"),"Hi, TIC team..."==$("#txtFeedback").val()&&$("#txtFeedback").val("")}),$("#txtFeedback").focusout(function(){""==$("#txtFeedback").val()&&($("#txtFeedback").attr("class","txtFeendbackNoFocus"),$("#txtFeedback").val("Hi, TIC team..."))}),$("#txtFeedbackComment").focus(function(){$("#txtFeedbackComment").attr("class","txtFeedbackComment"),"My Comments To This FeedBack..."==$("#txtFeedbackComment").val()&&$("#txtFeedbackComment").val("")}),$("#txtFeedbackComment").focusout(function(){""==$("#txtFeedbackComment").val()&&($("#txtFeedbackComment").attr("class","txtFeedbackCommentNoFocus"),$("#txtFeedbackComment").val("My Comments To This FeedBack..."))}),$("#sendFeedback").click(function(){var e=$.trim($("#txtFeedback").val());getLen(e);""==e||0==e.length||"Hi, TIC team..."==e?InvokeFeedbackReminder("FeedbackSucMask","FeedbackSucMaskFont","Please input your feedback first, thank you.","sendFeedback"):AddFeedback(e)}),$("#sendComment").click(function(){var e=$.trim($("#txtFeedbackComment").val());getLen(e);if(""==e||0==e.length||"My Comments To This FeedBack..."==e)InvokeCommentReminder("CommentSucMask","CommentSucMaskFont","Please input your comment first, thank you.","sendComment");else{
var t=$("#txtFeedbackID").val(),a=$("#txtAlias").val();AddFeedbackComments(e,t,a)}}),$("#feedByTime").click(function(){checkFilter("feedByTime")}),$("#feedByTime").mousedown(function(){$("#feedByTime").css("background-color","#000000"),$("#feedByTime").css("color","#ffffff")}),$("#feedByTime").mouseup(function(){$("#feedByTime").css("background-color","#000000"),$("#feedByTime").css("color","#ffffff")}),$("#feedByTime").mouseover(function(){$("#feedByTime").css("background-color","#000000"),$("#feedByTime").css("color","#ffffff")}),$("#feedByTime").mouseout(function(){1!=$("#RAfeedByTime").prop("checked")&&($("#feedByTime").css("background-color","#CD7011"),$("#feedByTime").css("color","#000000"))}),$("#feedByRate").click(function(){checkFilter("feedByRate")}),$("#feedByRate").mousedown(function(){$("#feedByRate").css("background-color","#000000"),$("#feedByRate").css("color","#ffffff")}),$("#feedByRate").mouseup(function(){$("#feedByRate").css("background-color","#000000"),$("#feedByRate").css("color","#ffffff")}),$("#feedByRate").mouseover(function(){$("#feedByRate").css("background-color","#000000"),$("#feedByRate").css("color","#ffffff")}),$("#feedByRate").mouseout(function(){1!=$("#RAfeedByRate").prop("checked")&&($("#feedByRate").css("background-color","#CD7011"),$("#feedByRate").css("color","#000000"))}),$("#backContent").click(function(){ViewCommentsByFeedbackID("","","","","","left")}),$("#backContent").mousedown(function(){$("#triangle-left").attr("class","triangle-left-onfocus"),$("#triangle-left-core").attr("class","triangle-left-core-onfocus")}),$("#backContent").mouseup(function(){$("#triangle-left").attr("class","triangle-left"),$("#triangle-left-core").attr("class","triangle-left-core")}),$("#backContent").mouseover(function(){$("#triangle-left").attr("class","triangle-left-onfocus"),$("#triangle-left-core").attr("class","triangle-left-core-onfocus")}),$("#backContent").mouseout(function(){$("#triangle-left").attr("class","triangle-left"),$("#triangle-left-core").attr("class","triangle-left-core")}),$("#feedbacktriangleup").click(function(){if("voteVolume"==$("#feedbackvotevolume").attr("class")){var e=$("#txtFeedbackID").val(),t=$("#feedbackvotevolume").html();AddFeedbackRate(e,t,"test"),$("#feedbackvotevolume").html(""),$("#feedbackvotevolume").html(parseInt(t)+1),$("#feedbackvotevolume").attr("class","voteVolumeDis"),$("#feedbacktriangleup").attr("class","triangle-up-dis")}})});