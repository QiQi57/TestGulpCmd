function getProductInfo(){var e="",t="",a="",n="",o=$("#okProductTreeHidden").val(),l=o,i=getHostUrl(),r="date",s=$("#startDateInput").val(),d=$("#endDateInput").val();DisableViewReportButton(),$.post(i+"/GetTaxonomyByProductTree.srv",{productLevel1:e,productLevel2:t,productLevel3:a,productLevel4:n,productVersion:l,type:r,startDate:s,endDate:d},function(e){filterDictJson=$.parseJSON(e);var t=filterDictJson.length,a=document.createDocumentFragment();return 1>t?($("#SP_Selection").find("option").remove().end().append("<option value='no'>(No taxonomy exists.)</option>"),$("#STL2_Selection").find("option").remove().end().append("<option value='no'>(No taxonomy exists.)</option>"),$("#DisplayLevel1").text("Taxonomy"),void $("#DisplayTaxonomy").text("Support Topic Level 1")):($.each(filterDictJson,function(e,t){var n=a.appendChild(document.createElement("Option"));n.text=t,n.value=t,a.appendChild(n)}),$("#SP_Selection").find("option").remove(),$("#SP_Selection").append("<option value='All'>All</option>").append(a).prop("disabled",!1),getSTL2(),void $(".filterTitle").show())})}function getSTL2(){var e=$("#SP_Selection").val(),t=getHostUrl(),a="";$("#SP_Selection option").each(function(){a+=$(this).val()+"^"}),$.post(t+"/GetSTL2.srv",{STL1:e,rcLevel1Options:a},function(e){for(var t=$("#STL2_Selection"),a=document.createDocumentFragment(),n=$.parseJSON(e),o=0,l=n.length;l>o;o++){var i=a.appendChild(document.createElement("option"));i.text=n[o],i.value=n[o]}t.find("option").remove(),t.append("<option value='All'>All</option>").append(a).prop("disabled",!1),$("#DisplayLevel1").text($("#SP_Selection option:selected").text()),$("#DisplayTaxonomy").text($("#STL2_Selection option:selected").text()),EnableViewReportButton()})}function sortFunction(e,t){for(var a=0,n=0,o=0;o<e.toString().length;o++)a+=e.charCodeAt(o);for(var o=0;o<t.toString().length;o++)n+=t.charCodeAt(o);return a-n}function NewIdea(e,t,a,n,o,l,i,r,s,d,c,$,u){var p=new Object;p.UserName=e,p.SupportId=t,p.FullPath=a,p.LaborP=n,p.Labor=o,p.TMPI=l,p.CaseVolP=i,p.CaseVol=r,p.TB=s,p.BB=d,p.TotalB=c,p.startDate=$,p.endDate=u,window.showModelessDialog("ideaform.aspx",p,"dialogWidth=700px;dialogHeight=700px")}function clearRadioButton(e,t){for(var a=document.getElementById(t),n=0;n<a.length;n++)a[n].name==e&&(document.getElementById(a[n].id).checked=!1,$("#Span"+a[n].id).attr("class",radio_unchecked))}function getHostUrl(){var e=window.location.protocol,t=window.location.host;return e+"//"+t+pathDir}function CloseDetailsBinding(){$("#closeDetails").click(function(){$("#detailsView").html(""),$("#closeDetails").attr("class","triangle-down-click"),$("#detailsView").fadeOut("slow")}),$("#closeDetails").mousedown(function(){$("#closeDetails").attr("class","triangle-down-click")}),$("#closeDetails").mouseup(function(){$("#closeDetails").attr("class","triangle-down")}),$("#closeDetails").mouseover(function(){$("#closeDetails").attr("class","triangle-down-click")}),$("#closeDetails").mouseout(function(){$("#closeDetails").attr("class","triangle-down")})}function CloseDetailsBindingTrend(){$("#closeTrend").click(function(){$("#trendContent").html("<div>Closing...</div>"),$("#trendTransition").hide(),$("#trendMask").hide(),$("#closeTrend").attr("class","triangle-down-click-trend")}),$("#closeTrend").mousedown(function(){$("#closeTrend").attr("class","triangle-down-click-trend")}),$("#closeTrend").mouseup(function(){$("#closeTrend").attr("class","triangle-down-trend")}),$("#closeTrend").mouseover(function(){$("#closeTrend").attr("class","triangle-down-click-trend")}),$("#closeTrend").mouseout(function(){$("#closeTrend").attr("class","triangle-down-trend")})}function ClickScore(e,t){$("#ScoreCardId").val(e),$("#ScoreCardName").val(t),$("#spanScorecard").text(t),$(this).css("font-weight","bold"),$("#orgAccord").load("_OrganizationSelect",{scorecardId:e},successLoadOrg)}function ClickOrg(e,t,a){$("#OrganizationId").val(e),$("#spanOrg").text(a),$("#OrganizationName").val(t),$(this).css("font-weight","bold"),$("#businessAccord").load("_BusinessSelect",{scorecardId:$("#ScoreCardId").val(),organizationId:e},successLoadBusiness),$("#regionAccord").load("_RegionSelect",{organizationId:e},successLoadRegion)}function ClickBusiness(e,t){$("#BusinessUnitId").val(e),$("#BusinessUnitName").val(t),$(this).css("font-weight","bold"),$("#spanBusiness").text(t);var a=$("#ScoreCardId").val(),n=$("#OrganizationId").val(),o=$("#BusinessUnitId").val(),l=$("#RegionId").val();""!=l&&"0"!=l&&($("#lobAccord").load("_LOBSelect",{scorecardId:a,organizationId:n,businessUnitId:o,regionId:l},successLoadLob),$("#lobAccord").css("display","inline"))}function ClickRegion(e,t){$("#RegionId").val(e),$("#RegionName").val(t),$("#spanRegion").text(t),$(this).css("font-weight","bold");var a=$("#ScoreCardId").val(),n=$("#OrganizationId").val(),o=$("#BusinessUnitId").val(),l=$("#RegionId").val();$("#lobAccord").load("_LOBSelect",{scorecardId:a,organizationId:n,businessUnitId:o,regionId:l},successLoadLob),$("#lobAccord").css("display","inline")}function ClickLOB(e){$("#"+e).is(":checked")?$("#"+e).is(":checked")&&(GetCat(),GetLob()):($("#check_all").attr("checked",!1),GetCat(),GetLob());var t=$("#ScoreCardId").val(),a=$("#OrganizationId").val(),n=$("#BusinessUnitId").val(),o=$("#Lob").val(),l=$("#RegionId").val();$("#catAccord").load("_CategorySelect",{scorecardId:t,organizationId:a,businessUnitId:n,regionId:l,lineOfBusinessId:o},successLoadCat),$("#catAccord").css("display","inline")}function ClickCat(e){$("#CategoryId").val(e),$("#"+e).is(":checked")||$("#check_allcat").attr("checked",!1)}function GetLob(){for(var e=document.getElementById("lobAccord"),t="",a=e.getElementsByTagName("input"),n=a.length,o=0;n>o;o++)"checkbox"===a[o].type&&a[o].checked&&a[o].name.match("^lobCheck")&&(t+=a[o].name.split("_")[1]+",");""!=t&&(document.getElementById("Lob").value=t.substring(0,t.length-1))}function GetCat(){for(var e=document.getElementById("catAccord"),t="",a=e.getElementsByTagName("input"),n=a.length,o=0;n>o;o++)"checkbox"===a[o].type&&a[o].checked&&a[o].name.match("^catCheck")&&(t+=a[o].name.split("_")[1]+",");""!=t&&(document.getElementById("Category").value=t.substring(0,t.length-1))}function Validate(){var e=!0,t="";return(""==$("#ScoreCardId").val()||"0"==$("#ScoreCardId").val())&&(t+="Please Select Scorecard Id\n",e=!1),""==$("#OrganizationId").val()&&(t+="Please Select Organization Id\n",e=!1),""==$("#BusinessUnitId").val()&&(t+="Please Select Business Unit Id\n",e=!1),""==$("#RegionId").val()&&(t+="Please Select Region Id\n",e=!1),""==$("#Lob").val()&&(t+="Please Select Lob Checkbox\n",e=!1),""==$("#Category").val()&&(t+="Please Select Category Checkbox\n",e=!1),""==$("#Year").val()&&(t+="Please Select Year\n",e=!1),(""==$("#Month").val()||"0"==$("#Month").val())&&(t+="Please Select Month\n",e=!1),0==e&&alert(t),e}function Prev(){var e=$("label[for=Year]").html(),t=parseInt(e)-1;$("label[for=Year]").html(t),document.getElementById("Year").value=$("label[for=Year]").html()}function Next(){var e=$("label[for=Year]").html(),t=parseInt(e)+1;$("label[for=Year]").html(t),document.getElementById("Year").value=$("label[for=Year]").html()}function ClickMonth(e){document.getElementById("Year").value=$("label[for=Year]").html(),document.getElementById("Month").value=e}function LevelClick(e){if(null!=$("#showContent"+e))if($("#showContent"+e).is(":visible")){var t=$("#expandcol"+e).attr("src");""!=t&&void 0!=t&&(t=t.replace("collapse-green.gif","expand-green.gif"),$("#expandcol"+e).attr("src",t),$("#showContent"+e).slideUp())}else{var t=$("#expandcol"+e).attr("src");""!=t&&void 0!=t&&(t=t.replace("expand-green.gif","collapse-green.gif"),$("#expandcol"+e).attr("src",t),$("#showContent"+e).slideDown())}}!function(e){e.fn.goTo=function(){return e("html, body").animate({scrollTop:e(this).offset().top+"px"},"slow"),this}}(jQuery);var filterDictJson;!function(e){e.fn.goTo=function(){return e("html, body").animate({scrollTop:e(this).offset().top+"px"},"slow"),this}}(jQuery),$(document).ready(function(){function e(){if($(window).scrollLeft()>0){var e=$(window).scrollLeft();$("#floatHeaderDiv").css("left",-e+89)}var t=$(window).scrollTop(),a=$("#floatHeaderDiv").height();t>373+a?$("#TICReportTable").is(":visible")&&($("#floatHeaderDiv").show(),$("#supportTopicTreeDiv").css("top",20),$("#supportTopicTreeDiv").css("position","fixed")):($("#floatHeaderDiv").hide(),$("#supportTopicTreeDiv").css("top",385),$("#supportTopicTreeDiv").css("position","absolute"))}function t(e){DisableViewReportButton(),$("#statisticDiv").html(""),$("#export").hide(),$("#showData").hide(),$("#detailsView").fadeOut(0);var t=$("#startDateInput").val(),a=$("#endDateInput").val();$("#txtStartDate").val(t),$("#txtEndDate").val(a);var n=$("#SP_Selection").val(),o=$("#STL2_Selection").val(),i=$('input[type="radio"][name="rank"]:checked').val(),r=$('input[type="radio"][name="top"]:checked').val();if(!t)return $("#warningTitle").html("View Report :"),$("#warningText").html("Please select start date."),void $(".warning").overlay().load();if(!a)return $("#warningTitle").html("View Report :"),$("#warningText").html("Please select end date."),void $(".warning").overlay().load();var s;s=$("#txtRegionHidden").val();var d=$("#okProductTreeHidden").val(),c=$("#txtOfferingTreeHidden").val();""==c||null==c?(c="all",$("#OffLevel1HiddenP").val("All"),$("#OffLevel2HiddenP").val("All"),$("#OffLevel3HiddenP").val("All")):(c=c.substring(0,c.length-1),$("#OffLevel1HiddenP").val($("#OffLevel1Hidden").val()),$("#OffLevel2HiddenP").val($("#OffLevel2Hidden").val()),$("#OffLevel3HiddenP").val($("#OffLevel3Hidden").val())),$("#TICReportTable > tbody").empty(),$("#TICReportTable").hide(),$("#TICReportTable2").hide();var u=getHostUrl();$("#copyRegion").val(s),$("#copyProductVersion").val(d),$("#copyPESServicedID").val(c);var p="";$("#filterForm input:radio:checked").each(function(e,t){p=$(this).attr("id")});var v="",h="",g="",f="",m="",w="";v=$("#tree").html(),v=escape(v),g=$("#tree").height(),f=$("#tree").width(),h=d,w="<all id='allid' text='all' value='all' showcheck='false' complete='true' checkstate='0' isexpand='true' hasChildren='true'>",w=l(allNodes[0].ChildNodes,w,0),w+="</all>",w=escape(w);var T=$("#txtProductTree").val();m=T.match(/\d+/)[0];var S="",b="",C="",x="",D="",y="";S=$("#offeringTree").html(),S=escape(S),C=$("#offeringTree").height(),x=$("#offeringTree").width(),b=c,y="<all id='allid' text='all' value='all' showcheck='false' complete='true' checkstate='0' isexpand='true' hasChildren='true'>",y=l(offeringallNodes[0].ChildNodes,y,0),y+="</all>",y=escape(y),T=$("#txtOfferingTree").val().toLowerCase(),D="selected all items"==T?"all":T.match(/\d+/)[0];var I=$('input[type="radio"][name="rank"]:checked').attr("id"),k=$('input[type="radio"][name="top"]:checked').attr("id"),L="";$("#SP_Selection option").each(function(){L+=$(this).val()+"^"});var B=n,P="";$("#STL2_Selection option").each(function(){P+=$(this).val()+"^"});var A=o;L=L.substring(0,L.length-1),P=P.substring(0,P.length-1),$("#ProLevel1HiddenP").val($("#ProLevel1Hidden").val()),$("#ProLevel2HiddenP").val($("#ProLevel2Hidden").val()),$("#ProLevel3HiddenP").val($("#ProLevel3Hidden").val());var R=getTrendStartDate(t,a);$("#trendStartDate").val(R),"click"==e&&SavePageStatusSeam(selectedSource,t,a,p,v,h,w,g,f,m,L,B,P,A,s,"",I,i,k,"Viewreport","Seam",$("#ProLevel1HiddenP").val(),$("#ProLevel2HiddenP").val(),$("#ProLevel3HiddenP").val(),"",S,b,y,C,x,D,$("#OffLevel1HiddenP").val(),$("#OffLevel2HiddenP").val(),$("#OffLevel3HiddenP").val()),$("#loadImageDiv").show(),TimerStart(),$.post(u+"/GetCaseInfoBySPL1WithSeam.srv",{startDate:t,endDate:a,productVersion:d,spl1:n,spl2:o,GeographyLevel3:s,rankType:i,rankValue:r,InputPESServiceID:c,Source:selectedSource},function(e){TimerStop(),$("#loadImageDiv").hide(),$("#showData").hide(),$(".saveAction").show();var t=$.parseJSON(e),n=t.TICInfoList,o=n.length;if(1>o)return $("#showData").show(),void EnableViewReportButton();var l,i=$("#HeadLoginView_HeadLoginName").text(),r=(i.split("\\")[1],""),s="",d="#fff",c=0,u=0,p=0,v=0,h=0;c=-1==t.AVGTMPI?"-":t.AVGTMPI.toFixed(1),u=-1==t.AVGDTS?"-":t.AVGDTS.toFixed(1),p=-1==t.AVGTB?"-":t.AVGTB.toFixed(1)+"%",v=-1==t.AVGBB?"-":t.AVGBB.toFixed(1)+"%",h=-1==t.TotalVolume?"-":parseInt(t.TotalVolume);for(var g,f,m,w,T,S,b,C=new RegExp("[http://*]|[https://*]"),x=1,D=!0,y=0,I=0;o>I;I++){d="#D3DFEE"==d?"#D3DFEE":"#fff",l=n[I].SeamContentList.length,l>0&&(g=n[I].SeamContentList[0],f=g.Title.toString(),m=g.ResourceURL.toString(),w=-1==g.PageViews?"-":g.PageViews,T=-1==g.SuccessRate?"-":g.SuccessRate,S=-1==g.SuccessCount?"-":g.SuccessCount,b=-1==g.ResponseCount?"-":g.ResponseCount,0==f.length&&(f=m),s=C.test(m)?"<td class='urlCell' style='text-align:left;padding-left:20px;'><a href='"+m+"' target='_blank'>"+f+"</a></td><td style='text-align:center;'>"+w+"</td><td style='text-align:center;'>"+T+"</td><td  style='text-align:center;'>"+S+"</td><td  style='text-align:center;'>"+b+"</td><tr>":"<td class='urlCell' style='text-align:left;padding-left:20px;'></td><td  style='text-align:center;'></td><td  style='text-align:center;'></td><td  style='text-align:center;'></td><td  style='text-align:center;'></td><tr>");for(var k=1;l>k;k++)g=n[I].SeamContentList[k],f=g.Title.toString(),m=g.ResourceURL.toString(),w=-1==g.PageViews?"-":g.PageViews,T=-1==g.SuccessRate?"-":g.SuccessRate,S=-1==g.SuccessCount?"-":g.SuccessCount,b=-1==g.ResponseCount?"-":g.ResponseCount,0==f.length&&(f=m),C.test(m)?s=s+"<tr style='background-color:"+d+"'><td style='text-align:left;padding-left:20px;'><a href='"+m+"' target='_blank'>"+f+"</a></td><td style='text-align:center;'>"+w+"</td><td style='text-align:center;'>"+T+"</td><td style='text-align:center;'>"+S+"</td><td style='text-align:center;'>"+b+"</td></tr>":l-=1;0==l&&(s="<td></td><td></td><td></td><td></td><td></td><tr>");var L=n[I].Symptom,B=n[I].RootCause,P=L.length,A="<table class='syRootTable'>";if(P>0)for(var O=0;P>O;O++)A+="<tr><td style='text-align:left; border-style:none; border-width:0px; overflow:hidden; word-wrap: break-word; text-overflow: ellipsis;'>"+L[O]+"</td></tr>";A+="</table>";var V=B.length,H="<table class='syRootTable' style='border-style:none; border-width:0px;'>";if(V>0)for(var _=0;V>_;_++)H+="<tr><td style='text-align:left; border-style:none; border-width:0px; overflow:hidden; word-wrap: break-word; text-overflow: ellipsis;'>"+B[_]+"</td></tr>";H+="</table>";var E,N,F,M,z,G,U,Y,W,J=n[I].SupportTopicDerivedID,j=0;-1==J&&($("#warningTitle").html("View Report :"),$("#warningText").html("Cannot find details about current Support Topic."),$(".warning").overlay().load()),E=-1==n[I].LaborBySupportTopicL2?"-":n[I].LaborBySupportTopicL2.toFixed(0),-1==n[I].LaborPresent?N="-":(N=n[I].LaborPresent.toFixed(1),N+="%"),F=-1==n[I].AvgTMPI?"-":n[I].AvgTMPI.toFixed(0),M=-1==n[I].AVG_DTS?"-":n[I].AVG_DTS.toFixed(0),0==h?(z="-",G="-"):-1==h?(z="-",G="-"):-1==h?(z="-",G="-"):(z=n[I].CaseVolume,G=(n[I].CaseVolume/h*100).toFixed(1),G+="%"),0==n[I].TotalSurvey?(U=0,Y="-",W="-"):-1==n[I].TotalSurvey?(U="-",Y="-",W="-"):(U=n[I].TotalSurvey,-1==n[I].CPE_TB?(Y="0",Y+="%"):(Y=(n[I].CPE_TB/n[I].TotalSurvey*100).toFixed(1),Y+="%"),-1==n[I].CPE_BB?(W="0",W+="%"):(W=(n[I].CPE_BB/n[I].TotalSurvey*100).toFixed(1),W+="%")),j=-1==n[I].IdeaCount?"-":n[I].IdeaCount;var Q=n[I].SupportTopicFullPath.split("\\").length,X=n[I].SupportTopicFullPath,q=n[I].SupportTopicFullPath.replace(/\"/gi,"&#34;").replace(/&/gi,"&#38;").replace(/'/gi,"&#39;").replace("(","&#40;","gi").replace(")","&#41;","gi").split("\\"),X="";$.each(q,function(e,t){X+=t+"^"}),X=X.substring(0,X.length-1);var K=R+" - "+a;D?3==Q&&(r="<tr style='background-color:"+d+"'><td rowspan="+(l+1)+">"+x.toString()+"</td><td rowspan="+(l+1)+"><a id='BA"+I+"' tag='"+J+"' href='#BB"+I+"' ><img id='imgBA"+I+"' class='TrendImage'   onclick='TrendClickEvent(\"BA"+I+'", "'+K+'" , "'+J+'", "'+X+'","'+N+'","'+E+'","'+F+'","'+G+'","'+z+'","'+Y+'","'+W+'","'+U+"\");' /></a></a><a style='display:none;'>BB"+I+"</a></td><td style='text-align:left;padding-left:20px;' rowspan="+(l+1)+">"+n[I].SupportTopicFullPath+"</td><td rowspan="+(l+1)+">"+N+"</td><td rowspan="+(l+1)+">"+E+"</td><td rowspan="+(l+1)+">"+F+"</td><td rowspan="+(l+1)+">"+M+"</td><td rowspan="+(l+1)+">"+G+"</td><td rowspan="+(l+1)+"><a id='AB"+I+"' tag='"+J+"'  onclick='enable(\"AB"+I+'", "'+X+"\")' href='#AA"+I+"' >"+z+"</a><a style='display:none;'>AA"+I+"</a></td><td rowspan="+(l+1)+">"+Y+"</td><td rowspan="+(l+1)+">"+W+"</td><td rowspan="+(l+1)+"><a id='SV"+I+"' tag='"+J+"'  onclick='enable(\"SV"+I+'", "'+X+"\",\"surveyVol\")' href='javascript:void(0)' >"+U+"</a></td><td rowspan="+(l+1)+">"+A+"</td><td rowspan="+(l+1)+" style='border-right-width:2px'>"+H+"</td>"+s,$("#TICReportTable>tbody").append(r),x+=1,d="#D3DFEE"==d?"#fff":"#D3DFEE",y+=1):(r="<tr style='background-color:"+d+"'><td rowspan="+(l+1)+">"+(I+1).toString()+"</td><td rowspan="+(l+1)+"><a id='BA"+I+"' tag='"+J+"' href='#BB"+I+"' ><img id='imgBA"+I+"' class='TrendImage'   onclick='TrendClickEvent(\"BA"+I+'", "'+K+'" , "'+J+'", "'+X+'","'+N+'","'+E+'","'+F+'","'+G+'","'+z+'","'+Y+'","'+W+'","'+U+"\");' /></a></a><a style='display:none;'>BB"+I+"</a></td><td style='text-align:left;padding-left:20px;' rowspan="+(l+1)+">"+n[I].SupportTopicFullPath+"</td><td rowspan="+(l+1)+">"+N+"</td><td rowspan="+(l+1)+">"+E+"</td><td rowspan="+(l+1)+">"+F+"</td><td rowspan="+(l+1)+">"+M+"</td><td rowspan="+(l+1)+">"+G+"</td><td rowspan="+(l+1)+"><a id='AB"+I+"' tag='"+J+"'  onclick='enable(\"AB"+I+'", "'+X+"\")' href='#AA"+I+"' >"+z+"</a><a style='display:none;'>AA"+I+"</a></td><td rowspan="+(l+1)+">"+Y+"</td><td rowspan="+(l+1)+">"+W+"</td><td rowspan="+(l+1)+"><a id='SV"+I+"' tag='"+J+"'  onclick='enable(\"SV"+I+'", "'+X+"\",\"surveyVol\")' href='javascript:void(0)' >"+U+"</a></td><td rowspan="+(l+1)+">"+A+"</td><td rowspan="+(l+1)+" style='border-right-width:2px'>"+H+"</td>"+s,$("#TICReportTable>tbody").append(r),y+=1),l=0,s="",r=""}var Z="<span>Total ST Number:<font style=';font-weight:bold' id='totalSTSpan'>"+o.toString()+"</font></span>&nbsp;&nbsp;<b>|</b>&nbsp;<span>Total SR Volume:<font style=';font-weight:bold' id='totalCaseSpan'>"+h+"</font></span>&nbsp;&nbsp;<b>|</b>&nbsp;<span>AVG TMPI:<font style=';font-weight:bold' id='AvgTMPI'>"+c+"</font></span>&nbsp;&nbsp;<b>|</b>&nbsp;<span>AVG DTS:<font style=';font-weight:bold' id='AvgDTS'>"+u+"</font></span>&nbsp;&nbsp;<b>|</b>&nbsp;<span>TB:<font style=';font-weight:bold' id='AvgTB'>"+p+"</font></span>&nbsp;&nbsp;<b>|</b>&nbsp;<span>BB:<font style=';font-weight:bold' id='AvgBB'>"+v+"</font></span>";if($("#statisticDiv").html(Z),$("#export").show(),D&&$("#totalSTSpan").text((x-1).toString()),!D||0==y)return $("#showData").show(),EnableViewReportButton(),$("#totalSTSpan").text(""),$("#totalCaseSpan").text(""),$("#AvgTMPI").text(""),$("#AvgDTS").text(""),$("#AvgTB").text(""),void $("#AvgBB").text("");$("#TICReportTable").show("slow"),$("#TICReportTable2").show("slow");var ee=$("#supportTopticTD").width(),te=$("#supportTopticTD").position();$("#supportTopicTreeDiv").css("left",te.left+20+ee+59),EnableViewReportButton()})}function a(){r=!0;var e=getHostUrl(),a=$("#txtPostBack").val();if("true"==a){$("#txtPostBack").val("false");var l=n().guid;void 0===l||($("#txtGuid").val(l),$.ajax({url:e+"/RestorePageStateHandler.srv",data:{guid:l},type:"POST",cache:!1,success:function(e){$("#SP_Selection").removeAttr("disabled"),$("#STL2_Selection").removeAttr("disabled");var a=$.parseJSON(e);if(a.length<1)return $("#warningTitle").html("Resotre Page Status :"),$("#warningText").html("No related filter info."),void $(".warning").overlay().load();switch(selectedSource=a.Source,a.Source){case"1":$("#sbis").removeClass("clusterNoSelect").addClass("clusterSelect"),$("#mssolve").removeClass("clusterSelect").addClass("clusterNoSelect"),$("#asbis_mssolve").removeClass("clusterSelect").addClass("clusterNoSelect");break;case"2":$("#mssolve").removeClass("clusterNoSelect").addClass("clusterSelect"),$("#asbis_mssolve").removeClass("clusterSelect").addClass("clusterNoSelect"),$("#sbis").removeClass("clusterSelect").addClass("clusterNoSelect");break;default:$("#asbis_mssolve").removeClass("clusterNoSelect").addClass("clusterSelect"),$("#sbis").removeClass("clusterSelect").addClass("clusterNoSelect"),$("#mssolve").removeClass("clusterSelect").addClass("clusterNoSelect")}$("#txtRegionHidden").val(a.Region),$("#txtStartDate").val(a.StartDate),$("#txtEndDate").val(a.EndDate);var n=getTrendStartDate(a.StartDate,a.EndDate);$("#trendStartDate").val(n),$("#copyRegion").val(a.Region),$("#copyProductVersion").val(a.TreeID),$("#okProductTreeHidden").val(a.TreeID),$("#copyPESServicedID").val(a.OffTreeID),$("#txtOfferingTreeHidden").val(a.OffTreeID),$("#ProLevel1Hidden").val(a.ProductLevel1),$("#ProLevel2Hidden").val(a.ProductLevel2),$("#ProLevel3Hidden").val(a.ProductLevel3),$("#OffLevel1Hidden").val(a.OffLevel1),$("#OffLevel2Hidden").val(a.OffLevel2),$("#OffLevel3Hidden").val(a.OffLevel3);var l=a.StartDate;$("#startDateInput").val(l);var i=a.EndDate;$("#endDateInput").val(i);var r=a.QuickDate;$("#"+r).attr("checked",!0),$("#Span"+r).attr("class",radio_checked);var s=escapeText(unescape(a.TreeNodes));s=$.parseXML(s);var d=(unescape(a.TreeHtml),$(s).find("all")),c={id:d.attr("id"),Text:d.attr("text"),value:d.attr("value"),showcheck:"true"==d.attr("showcheck")?!0:!1,complete:"true"==d.attr("complete")?!0:!1,isexpand:"true"==d.attr("isexpand")?!0:!1,checkstate:d.attr("checkstate"),hasChildren:"true"==d.attr("hasChildren")?!0:!1,Level:"0"};if($(s).find("all").children().length>0){var u=CreateDataSource(c,$(s).find("all").children(),0);c.ChildNodes=u,o.data=[c],identifier=!1,$("#tree").treeview(o),$("#tree").width(parseInt(a.TreeWidth)),$("#closeTreeDiv").width(parseInt(a.TreeWidth)),$("#searchDiv").width(parseInt(a.TreeWidth)),$(".searchtextbox").width(parseInt(a.TreeWidth)-10),$("#productsNameList").width(parseInt(a.TreeWidth)),$("#calculatingDiv").width(parseInt(a.TreeWidth)),$("#tree").height(parseInt(a.TreeHeight)),$("#closeTreeDiv").height(parseInt(a.TreeHeight)+20),$("#calculatingDiv").height(parseInt(a.TreeHeight)),$("#calculatingPar").css("margin-top",(parseInt(a.TreeHeight)+28-72)/2),$("#txtProductTree").attr("value","Selected "+a.TreeItems+" items"),selectedProducts=a.TreeID+",",$("#txtProductTreeHidden").attr("value",selectedProducts)}var p=unescape(a.OffTreeNodes);p=$.parseXML(p);var v=(unescape(a.OffTreeHtml),$(p).find("all")),h={id:v.attr("id"),Text:v.attr("text"),value:v.attr("value"),showcheck:"true"==v.attr("showcheck")?!0:!1,complete:"true"==v.attr("complete")?!0:!1,isexpand:"true"==v.attr("isexpand")?!0:!1,checkstate:v.attr("checkstate"),hasChildren:"true"==v.attr("hasChildren")?!0:!1,Level:"0"};if($(p).find("all").children().length>0){var u=CreateDataSource(h,$(p).find("all").children(),0);h.ChildNodes=u,offeringTree.data=[h],identifierForOfferingTree=!1,$("#offeringTree").offeringtreeview(offeringTree),$("#offeringTree").height(parseInt(a.OffTreeHeight)),$("#closeOfferingTreeDiv").height(parseInt(a.OffTreeHeight)+20),$("#calculatingDiv").height(parseInt(a.OffTreeHeight)),$("#offeringTree").width(parseInt(a.OffTreeWidth)),$("#closeOfferingTreeDiv").width(parseInt(a.OffTreeWidth)),$("#searchOffTrDiv").width(parseInt(a.OffTreeWidth)),$("#offTrMatchTextbox").width(parseInt(a.OffTreeWidth)-10),$("#offeringNameList").width(parseInt(a.OffTreeWidth)),$("#calculatingDiv").width(parseInt(a.OffTreeWidth)),$("#calculatingPar").css("margin-top",(parseInt(a.OffTreeHeight)+28-72)/2),$("#txtOfferingTree").attr("value","Selected "+a.OffTreeItems+" items"),offeringselectedProducts=a.OffTreeID+",",$("#txtOfferingTreeHidden").attr("value",offeringselectedProducts)}var g=a.Taxonomy,f=new Array;f=g.split("^"),$.each(f,function(e,t){$("#SP_Selection").append("<option value='"+t+"'>"+t+"</option>")});var m=a.TaxonomySelected;$("#SP_Selection").find("option[value='"+m+"']").attr("selected",!0),$("#DisplayLevel1").text(m);var w=a.SupportTopicLevel1,T=new Array;T=w.split("^"),$.each(T,function(e,t){$("#STL2_Selection").append("<option value='"+t+"'>"+t+"</option>")});var S=a.SupportTopicLevel1Selected;$("#STL2_Selection").find("option[value='"+S+"']").attr("selected",!0),$("#DisplayTaxonomy").text(S);var b=a.Region;if(""!=b){var C=new Array;C=b.split("^"),$("#RegionList input:checkbox").each(function(e,t){$(this).attr("checked",!1)});var x=0;$.each(C,function(e,t){$("#RegionList input:checkbox").each(function(e,a){"All"==b?$(this).attr("checked",!0):$(this).val()==t&&($(this).attr("checked",!0),x+=1)})}),"All"==b?$("#txtRegion").val("Selected all 12 items"):$("#txtRegion").val("Selected "+x+" items")}var D=a.RankType;$("#RadioFieldID10").attr("checked",!1),$("#SpanRadioFieldID10").attr("class",cluster_unchecked),$("#"+D).attr("checked",!0),$("#Span"+D).attr("class",cluster_checked);var y=a.RankValue;$("#filterForm3 input[type='radio'][name='top']:checked").attr("checked",!1),$("#filterForm3 span.clusterSelect").attr("class",cluster_unchecked),$("#"+y).attr("checked",!0),$("#Span"+y).attr("class",cluster_checked),t("restore")},error:function(e){alert("error")}}))}}function n(){for(var e,t=[],a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),n=0;n<a.length;n++)e=a[n].split("="),t.push(e[0]),t[e[0]]=e[1];return t}function l(e,t,a){var n="";return a+=1,$.each(e,function(e,o){null!=o.ChildNodes?(t=t+"<SupportLevel"+a+" id='"+o.id+"' text='"+o.Text+"' value='"+o.Value+"' showcheck='"+o.showcheck+"' complete='"+o.complete+"' checkstate='"+o.checkstate+"' isexpand='"+!0+"' hasChildren='"+o.hasChildren+"'>",n=l(o.ChildNodes,t,a),t=n):t=t+"<SupportLevel"+a+" id='"+o.id+"' text='"+o.Text+"' value='"+o.Value+"' showcheck='"+o.showcheck+"' complete='"+o.complete+"' checkstate='"+o.checkstate+"' isexpand='"+!1+"' hasChildren='"+o.hasChildren+"'>",t=t+"</SupportLevel"+a+">",n=t}),n}var i=n().guid;$("#txtGuid").val(i),DisableViewReportButton(),$("#loadImageDiv").hide(),$("#showData").hide(),$("#floatHeaderDiv").hide(),$("#report_image").hide(),$("#reportFrame").hide(),$("#quickTimeSelector").change(function(){var e,t=new Date,a=t.getDate(),n=t.getMonth()+1,o=t.getFullYear();10>a&&(a="0"+a),10>n&&(n="0"+n),t=n+"/"+a+"/"+o;var l=$(this).val();if("ytd"==l)$("#startDateInput").val("07/01/2012");else if("3"==l){var e=new Date(t);e.setMonth(e.getMonth()-2),$("#startDateInput").val(e.getMonth()+"/"+e.getDate()+"/"+e.getFullYear())}else if("6"==l){var e=new Date(t);e.setMonth(e.getMonth()-5),$("#startDateInput").val(e.getMonth()+"/"+e.getDate()+"/"+e.getFullYear())}}),$("#SP_Selection").change(function(){$("#DisplayLevel1").text($("#SP_Selection option:selected").text()),DisableViewReportButton(),$("#STL2_Selection").attr("disabled",!0),getSTL2()}),$("#STL2_Selection").change(function(){$("#DisplayTaxonomy").text($("#STL2_Selection option:selected").text())}),e(),$(window).scroll(e),$(window).resize(e),$("#overlay").overlay({mask:{color:"#fff",loadSpeed:200,opacity:.5},closeOnClick:!1,onBeforeClose:function(){}}),$("#close").click(function(){$("#overlay").overlay().close()}),$("#close").mousedown(function(){$("#close").attr("class","buttonClick")}),$("#close").mouseup(function(){$("#close").attr("class","metroButton")}),$("#close").mouseover(function(){$("#close").attr("class","buttonOver")}),$("#close").mouseout(function(){$("#close").attr("class","metroButton")}),CloseDetailsBinding(),$("#export").click(function(){var e=$("#export"),t=getHostUrl(),a="seam",n=null==$("#totalSTSpan").text()?"-":$("#totalSTSpan").text(),o=null==$("#totalCaseSpan").text()?"-":$("#totalCaseSpan").text(),l=null==$("#AvgTMPI").text()?"-":$("#AvgTMPI").text(),i=null==$("#AvgDTS").text()?"-":$("#AvgDTS").text(),r=null==$("#AvgTB").text()?"-":$("#AvgTB").text(),s=null==$("#AvgBB").text()?"-":$("#AvgBB").text();e.attr("disabled","disabled"),$.ajax({url:t+"/ExportExcel.srv",data:{type:a,TotalSTNumber:n,TotalSRVolume:o,AVGTMPI:l,AVGDTS:i,AVGTB:r,AVGBB:s},cache:!1,success:function(t){'"-1"'==t?($("#warningTitle").html("Export Excel Warning :"),$("#warningText").html("No data need to be exported, please view report first."),$(".warning").overlay().load()):'"0"'==t?($("#warningTitle").html("Export Excel Warning :"),$("#warningText").html("Report columns is 0, please view report again."),$(".warning").overlay().load()):($("#iframe").attr("src","ExportExcel.srv?type=seam&TotalSTNumber="+n+"&TotalSRVolume="+o+"&AVGTMPI="+l+"&AVGDTS="+i+"&AVGTB="+r+"&AVGBB="+s),$("#iframe").load()),e.removeAttr("disabled")},error:function(t){alert("error"),e.removeAttr("disabled")}})}),$("#viewReportLink").click(function(){t("click")});var r=!0;1==r&&a(),$(".spexpandLink").live("click",function(e){$(this).hide();var t=$("#startDateInput").val(),a=$("#endDateInput").val(),n=$(this).attr("spl1"),o=$(this).attr("spl2"),l=$(this).attr("rank"),i=getHostUrl();$.post(i+"/GetContentInfo.srv",{startDate:t,endDate:a,spl1:n,spl2:o},function(e){$("#"+l+"_div").hide();for(var t=$.parseJSON(e),a=t.length,n="",o=0;a>o;o++)n=n+"<tr><td width='200px'>"+t[o].ResourceURL+"</td><td>"+t[o].LinkCount+"</td><td>"+t[o].ResourceType+"</td><td>"+t[o].OriginationMethod+"</td></tr>";var i="<table><thead><tr><td>Resource URL</td><td>Usage Count</td><td>Resouce Type</td><td>Origination Method</td></tr></thead><tbody>"+n+"</tbody></table>";$("#"+l+"_div").append(i),$("#"+l+"_div").show("slow"),$("#"+l+"_div").goTo()})});var s=new Date,d=s.getDate(),c=s.getMonth()+1,u=s.getFullYear();if(10>d&&(d="0"+d),10>c&&(c="0"+c),s=c+"/"+d+"/"+u,7>c){var p="07/01/"+(u-1);$("#startDateInput").val(p)}else{var p="07/01/"+u;$("#startDateInput").val(p)}$("#endDateInput").val(s),$("#startDateInput").datepicker({defaultDate:"+1w",changeMonth:!0,changeYear:!0,numberOfMonths:1,showAnim:"slideDown",onSelect:function(e){clearRadioButton("radio","filterForm"),getProductInfo()}}),$("#endDateInput").datepicker({defaultDate:"+1w",changeMonth:!0,changeYear:!0,numberOfMonths:1,showAnim:"slideDown",onSelect:function(e){clearRadioButton("radio","filterForm"),getProductInfo()}})}),$(window).resize(function(){var e=screen.width,t=screen.height,a=$(window).width();$(window).height();e>a?($("body").addClass("overflowHidden"),$("body").removeClass("overflowNull")):a>=e&&($("#width").addClass("widthauto"),$("body").addClass("overflowNull"),$("body").removeClass("overflowHidden")),$(".scorecardSec")&&$(".trigger").outerHeight()>t?$(".trigger").css("min-height",$(".scorecardSec").outerHeight()):$(".trigger").css("min-height",t)});var panelIsVisible=!1;$(document).ready(function(){$(".trigger").click(function(){var e=-1;if(e=$("#txtTag").val(),-1!=e){var t=$("#"+e).position();null!=t&&"trigger active"==$(this).attr("class")}$(".panel").toggle("slow");var a=250,n=$("#calculatingDiv").position();return panelIsVisible?($("#calculatingDiv").is(":visible")&&(panelIsVisible=!0,$("#calculatingDiv").animate({left:n.left-a+"px"},"slow")),panelIsVisible=!1):($("#calculatingDiv").is(":visible")&&(panelIsVisible=!0,$("#calculatingDiv").animate({left:n.left+a+"px"},"slow")),panelIsVisible=!0),$(this).toggleClass("active"),!1});var e=1349,t=$(window).width();$(window).height();e>t?($("#width").addClass("widthfix"),$("body").addClass("overflowHidden")):t>=e&&($("#width").addClass("widthauto"),$("body").addClass("overflowNull")),$(".body").css("min-height",screen.height),$(".body").css("min-width",screen.width),$(".scorecardSec")&&$(".trigger").outerHeight()>screen.height?$(".trigger").css("min-height",$(".scorecardSec").outerHeight()):$(".trigger").css("min-height",screen.height)}),$(document).ready(function(){$(".scoreCard").click(function(){$("#scoreCardContent").is(":visible")?($("#scoreCardContent").slideUp(),$(this).removeClass("active").html("+ Scorecard ")):($("#scoreCardContent").slideDown(),$(this).addClass("active").html("-  Scorecard "))}),$(".business").click(function(){$("#businessContent").is(":visible")?($("#businessContent").slideUp(),$(this).removeClass("active").html("+ Business :")):($("#businessContent").slideDown(),
$(this).addClass("active").html("-  Business :"))}),$(".region").click(function(){$("#regionContent").is(":visible")?($("#regionContent").slideUp(),$(this).removeClass("active").html("+ Region :")):($("#regionContent").slideDown(),$(this).addClass("active").html("-  Region :"))}),$(".organization").click(function(){$("#organizationContent").is(":visible")?($("#organizationContent").slideUp(),$(this).removeClass("active").html("+ Organization :")):($("#organizationContent").slideDown(),$(this).addClass("active").html("-  Organization :"))}),$("a.calLnk").click(function(){$("a.calLnk").removeClass("calSelected"),$(this).addClass("calSelected")}),$("a.lnkScore").click(function(){$("a.lnkScore").css("font-weight","normal"),$(this).css("font-weight","bold")})});var successLoadOrg=function(){$("#organizationContent").slideDown(),$(".organization").addClass("active").html("-  Organization :"),$(".organization").click(function(){$("#organizationContent").is(":visible")?($("#organizationContent").slideUp(),$(this).removeClass("active").html("+ Organization :")):($("#organizationContent").slideDown(),$(this).addClass("active").html("-  Organization :"))})},successLoadCat=function(){$(document).ready(function(){$(".brandAllCat .checkbox").dgStyle(),$(".checkbox input").is(":checked")?$(".brandAllCat").css("color","#ffffff"):$(".brandAllCat").css("color","#000000")})},successLoadBusiness=function(){$("#businessContent").slideDown(),$(".business").addClass("active").html("-  Business :"),$(".business").click(function(){$("#businessContent").is(":visible")?($("#businessContent").slideUp(),$(this).removeClass("active").html("+ Business :")):($("#businessContent").slideDown(),$(this).addClass("active").html("-  Business :"))})},successLoadRegion=function(){$("#regionContent").slideDown(),$(".region").addClass("active").html("-  Region :"),$(".region").click(function(){$("#regionContent").is(":visible")?($("#regionContent").slideUp(),$(this).removeClass("active").html("+ Region :")):($("#regionContent").slideDown(),$(this).addClass("active").html("-  Region :"))})},successLoadLob=function(){$(document).ready(function(){$(".brandAllLob .checkbox").dgStyle(),$(".checkbox input").is(":checked")?$(".brandAllLob").css("color","#ffffff"):$(".brandAllLob").css("color","#000000")})};$("#LobId").click(function(){$(this).is(":checked")&&alert("checked")}),$(document).ready(function(){var e="";e="False",(e="True")&&($("#scoreCardContent").text().length>0&&($("#scoreCardContent").slideDown(),$(".scoreCard").addClass("active").html("-  Scorecard ")),$("#businessContent").text().length>0&&($("#businessContent").slideDown(),$(".business").addClass("active").html("-  Business :")),$("#regionContent").text().length>0&&($("#regionContent").slideDown(),$(".region").addClass("active").html("-  Region :")),$("#organizationContent").text().length>0&&($("#organizationContent").slideDown(),$(".organization").addClass("active").html("-  Organization :"))),$("#viewReportLink").click(function(){})});var TimeFlag,t=0;